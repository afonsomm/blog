<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Afonso Matoso Magalhães">

<title>Afonso Matoso Magalhães - fastai: Image Classifier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Afonso Matoso Magalhães</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:afonsomm98@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">fastai: Image Classifier</h1>
            <p class="subtitle lead">Application of the fastai library to multiple image classification datasets.</p>
                                <div class="quarto-categories">
                <div class="quarto-category">deep learning</div>
                <div class="quarto-category">image classification</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Afonso Matoso Magalhães </p>
            </div>
    </div>
      
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">last-modified</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lesson-1" id="toc-lesson-1" class="nav-link active" data-scroll-target="#lesson-1">Lesson 1</a>
  <ul class="collapse">
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#train-model" id="toc-train-model" class="nav-link" data-scroll-target="#train-model">Train Model</a></li>
  <li><a href="#test-model" id="toc-test-model" class="nav-link" data-scroll-target="#test-model">Test Model</a></li>
  </ul></li>
  <li><a href="#lesson-2" id="toc-lesson-2" class="nav-link" data-scroll-target="#lesson-2">Lesson 2</a></li>
  <li><a href="#lesson-3" id="toc-lesson-3" class="nav-link" data-scroll-target="#lesson-3">Lesson 3</a>
  <ul class="collapse">
  <li><a href="#timm" id="toc-timm" class="nav-link" data-scroll-target="#timm">timm</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#inference-results" id="toc-inference-results" class="nav-link" data-scroll-target="#inference-results">Inference results</a></li>
  <li><a href="#training-results" id="toc-training-results" class="nav-link" data-scroll-target="#training-results">Training results</a></li>
  <li><a href="#use-model" id="toc-use-model" class="nav-link" data-scroll-target="#use-model">Use model</a></li>
  </ul></li>
  <li><a href="#mnist" id="toc-mnist" class="nav-link" data-scroll-target="#mnist">MNIST</a>
  <ul class="collapse">
  <li><a href="#load-data-1" id="toc-load-data-1" class="nav-link" data-scroll-target="#load-data-1">Load Data</a></li>
  <li><a href="#train-model-1" id="toc-train-model-1" class="nav-link" data-scroll-target="#train-model-1">Train Model</a></li>
  <li><a href="#test-model-1" id="toc-test-model-1" class="nav-link" data-scroll-target="#test-model-1">Test Model</a></li>
  </ul></li>
  <li><a href="#animals" id="toc-animals" class="nav-link" data-scroll-target="#animals">Animals</a>
  <ul class="collapse">
  <li><a href="#load-data-2" id="toc-load-data-2" class="nav-link" data-scroll-target="#load-data-2">Load Data</a></li>
  <li><a href="#train-model-2" id="toc-train-model-2" class="nav-link" data-scroll-target="#train-model-2">Train Model</a></li>
  <li><a href="#test-model-2" id="toc-test-model-2" class="nav-link" data-scroll-target="#test-model-2">Test Model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div id="cell-1" class="cell" data-executioninfo="{&quot;elapsed&quot;:21449,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785585228,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="7609b9fb-3e3c-4770-df61-448ef78bebd9" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mounted at /content/drive</code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785593008,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="e0142e1b-26ea-4ee0-eda1-ef065cf7f3a6" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd <span class="op">/</span>content<span class="op">/</span>drive<span class="op">/</span>MyDrive<span class="op">/</span>fastai course<span class="op">/</span>Aula <span class="dv">1</span>, <span class="dv">2</span> e <span class="fl">3.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/content/drive/MyDrive/fastai course/Aula 1, 2 e 3.1</code></pre>
</div>
</div>
<section id="lesson-1" class="level1">
<h1>Lesson 1</h1>
<ul>
<li>https://course.fast.ai/Lessons/lesson1.html</li>
</ul>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install -Uqq duckduckgo_search</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> duckduckgo_search <span class="im">import</span> DDGS</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastdownload <span class="im">import</span> download_url</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_images(term, max_images<span class="op">=</span><span class="dv">30</span>):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Searching for '</span><span class="sc">{</span>term<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> L(DDGS().images(keywords<span class="op">=</span>term, max_results<span class="op">=</span>max_images)).itemgot(<span class="st">'image'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s start by searching for a bird photo and seeing what kind of result we get. We’ll start by getting URLs from a search:</p>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_path <span class="op">=</span> Path(<span class="st">"./data/lesson1"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_path.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-outputid="4b6f3b60-ef82-4d20-e8e9-362ef4669fe8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bird_urls <span class="op">=</span> search_images(<span class="st">'bird photo'</span>, max_images<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>download_url(bird_urls[<span class="dv">0</span>], data_path<span class="op">/</span><span class="st">"bird.jpg"</span>, show_progress<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(data_path<span class="op">/</span><span class="st">"bird.jpg"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>im.to_thumb(<span class="dv">256</span>,<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'bird photo'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s do the same with “forest photos”:</p>
<div id="cell-13" class="cell" data-outputid="e9222cc4-7abf-4c4b-8e6d-5df2143d9044">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>forest_urls <span class="op">=</span> search_images(<span class="st">'forest photo'</span>, max_images<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>download_url(forest_urls[<span class="dv">0</span>], data_path<span class="op">/</span><span class="st">"forest.jpg"</span>, show_progress<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(data_path<span class="op">/</span><span class="st">"forest.jpg"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>im.to_thumb(<span class="dv">256</span>,<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'forest photo'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s do the same with “cat photo”, “dog photo”, and “wolf photo”:</p>
<div id="cell-15" class="cell" data-outputid="aa1e1b8a-344a-40ca-888d-4d57f6228e35">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cat_urls <span class="op">=</span> search_images(<span class="st">'cat photo'</span>, max_images<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>download_url(cat_urls[<span class="dv">0</span>], data_path<span class="op">/</span><span class="st">"cat.jpg"</span>, show_progress<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(data_path<span class="op">/</span><span class="st">"cat.jpg"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>im.to_thumb(<span class="dv">256</span>,<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'cat photo'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-outputid="ee9d4f22-3ad6-46c8-84c2-f014ee57a702">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dog_urls <span class="op">=</span> search_images(<span class="st">'dog photo'</span>, max_images<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>download_url(dog_urls[<span class="dv">0</span>], data_path<span class="op">/</span><span class="st">"dog.jpg"</span>, show_progress<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(data_path<span class="op">/</span><span class="st">"dog.jpg"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>im.to_thumb(<span class="dv">256</span>,<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'dog photo'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-outputid="12cd73ab-ac39-4825-b117-6f27985cd7e8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wolf_urls <span class="op">=</span> search_images(<span class="st">'wolf photo'</span>, max_images<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>download_url(wolf_urls[<span class="dv">0</span>], data_path<span class="op">/</span><span class="st">"wolf.jpg"</span>, show_progress<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(data_path<span class="op">/</span><span class="st">"wolf.jpg"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>im.to_thumb(<span class="dv">256</span>,<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'wolf photo'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Our searches seem to be giving reasonable results, so let’s grab a few examples of each, and save each group of photos to a different folder (I’m also trying to grab a range of lighting conditions here):</p>
<div id="cell-19" class="cell" data-outputid="87210dcb-2c8e-4246-da0e-52207b4bc6c3">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>searches <span class="op">=</span> <span class="st">'forest'</span>,<span class="st">'bird'</span>,<span class="st">'cat'</span>,<span class="st">'dog'</span>,<span class="st">'wolf'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>imgs_path <span class="op">=</span> data_path<span class="op">/</span><span class="st">"imgs"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> sleep</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> o <span class="kw">in</span> searches:</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    dest <span class="op">=</span> imgs_path<span class="op">/</span><span class="ss">f"</span><span class="sc">{</span>o<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    dest.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>, parents<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    download_images(dest, urls<span class="op">=</span>search_images(<span class="ss">f'</span><span class="sc">{</span>o<span class="sc">}</span><span class="ss"> photo'</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    sleep(<span class="dv">10</span>)  <span class="co"># Pause between searches to avoid over-loading server</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    download_images(dest, urls<span class="op">=</span>search_images(<span class="ss">f'</span><span class="sc">{</span>o<span class="sc">}</span><span class="ss"> photo sun'</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    sleep(<span class="dv">10</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    download_images(dest, urls<span class="op">=</span>search_images(<span class="ss">f'</span><span class="sc">{</span>o<span class="sc">}</span><span class="ss"> photo shade'</span>))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    sleep(<span class="dv">10</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    resize_images(path<span class="op">/</span>o, max_size<span class="op">=</span><span class="dv">400</span>, dest<span class="op">=</span>path<span class="op">/</span>o)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Searching for 'forest photo'
Searching for 'forest photo sun'
Searching for 'forest photo shade'
Searching for 'bird photo'
Searching for 'bird photo sun'
Searching for 'bird photo shade'
Searching for 'cat photo'
Searching for 'cat photo sun'
Searching for 'cat photo shade'
Searching for 'dog photo'
Searching for 'dog photo sun'
Searching for 'dog photo shade'
Searching for 'wolf photo'
Searching for 'wolf photo sun'
Searching for 'wolf photo shade'</code></pre>
</div>
</div>
</section>
<section id="train-model" class="level2">
<h2 class="anchored" data-anchor-id="train-model">Train Model</h2>
<p>Some photos might not download correctly which could cause our model training to fail, so we’ll remove them:</p>
<div id="cell-22" class="cell" data-outputid="03c2bc0a-796a-4dbe-b237-ed861815d3b1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>failed <span class="op">=</span> verify_images(get_image_files(imgs_path))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>failed.<span class="bu">map</span>(Path.unlink)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(failed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>14</code></pre>
</div>
</div>
<p>To train a model, we’ll need <code>DataLoaders</code>, which is an object that contains a training set (the images used to create a model) and a validation set (the images used to check the accuracy of a model – not used during training). In fastai we can create that easily using a <code>DataBlock</code>, and view sample images from it:</p>
<div id="cell-24" class="cell" data-outputid="4848b2c8-e25f-42ef-92f2-a8299a87080f">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                get_items<span class="op">=</span>get_image_files,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                splitter<span class="op">=</span>RandomSplitter(valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">0</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                get_y<span class="op">=</span>parent_label,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                item_tfms<span class="op">=</span>[Resize(<span class="dv">192</span>, method<span class="op">=</span><span class="st">"squish"</span>)]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(imgs_path)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>dls.show_batch(max_n<span class="op">=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here what each of the <code>DataBlock</code> parameters means:</p>
<p><code>blocks=(ImageBlock, CategoryBlock),</code> - The inputs to our model are images, and the outputs are categories (in this case, “forest”, “bird”, “cat”, “dog” or “wolf”).</p>
<p><code>get_items=get_image_files,</code> - To find all the inputs to our model, run the get_image_files function (which returns a list of all image files in a path).</p>
<p><code>splitter=RandomSplitter(valid_pct=0.2, seed=42),</code> - Split the data into training and validation sets randomly, using 20% of the data for the validation set.</p>
<p><code>get_y=parent_label,</code> - The labels (<code>y</code> values) is the name of the <code>parent</code> of each file (i.e.&nbsp;the name of the folder they’re in, which will be “forest”, “bird”, “cat”, “dog” or “wolf”).</p>
<p><code>item_tfms=[Resize(192, method='squish')]</code> - Before training, resize each image to 192x192 pixels by “squishing” it (as opposed to cropping it).</p>
<p>Now we’re ready to train our model. The fastest widely used computer vision model is <code>resnet18</code>. You can train this in a few minutes, even on a CPU! (On a GPU, it generally takes under 10 seconds…)</p>
<p><code>fastai</code> comes with a helpful <code>fine_tune()</code> method which automatically uses best practices for fine tuning a pre-trained model, so we’ll use that.</p>
<div id="cell-32" class="cell" data-outputid="af307b4c-4248-4bec-ce02-28075158aa6d">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.004911</td>
<td>0.474476</td>
<td>0.192771</td>
<td>00:49</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.505954</td>
<td>0.225417</td>
<td>0.096386</td>
<td>00:48</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.326397</td>
<td>0.217455</td>
<td>0.084337</td>
<td>00:48</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.236130</td>
<td>0.237563</td>
<td>0.096386</td>
<td>00:48</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>“Fine-tuning” a model means that we’re starting with a model someone else has trained using some other dataset (called the pretrained model), and adjusting the weights a little bit so that the model learns to recognise your particular dataset. In this case, the pretrained model was trained to recognise photos in imagenet, and widely-used computer vision dataset with images covering 1000 categories) For details on fine-tuning and why it’s important, check out the free <a href="https://course.fast.ai/">free fast.ai course</a>.</p>
</section>
<section id="test-model" class="level2">
<h2 class="anchored" data-anchor-id="test-model">Test Model</h2>
<p>Let’s see what our model thinks about that bird we downloaded at the start:</p>
<div id="cell-36" class="cell" data-outputid="e2aeb6f3-0d35-486d-e434-91be3de3f631">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>is_bird,_,probs <span class="op">=</span> learn.predict(PILImage.create(data_path<span class="op">/</span><span class="st">'bird.jpg'</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This is a: </span><span class="sc">{</span>is_bird<span class="sc">}</span><span class="ss">."</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Probability it's a bird: </span><span class="sc">{</span>probs[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>This is a: bird.
Probability it's a bird: 0.9998</code></pre>
</div>
</div>
<p>Good job, resnet18. :)</p>
<p>So, as you see, in the space of a few years, creating computer vision classification models has gone from “so hard it’s a joke” to “trivially easy and free”!</p>
<p>It’s not just in computer vision. Thanks to deep learning, computers can now do many things which seemed impossible just a few years ago, including <a href="https://openai.com/dall-e-2/">creating amazing artworks</a>, and <a href="https://www.datanami.com/2022/04/22/googles-massive-new-language-model-can-explain-jokes/">explaining jokes</a>. It’s moving so fast that even experts in the field have trouble predicting how it’s going to impact society in the coming years.</p>
<p>One thing is clear – it’s important that we all do our best to understand this technology, because otherwise we’ll get left behind!</p>
</section>
</section>
<section id="lesson-2" class="level1">
<h1>Lesson 2</h1>
<ul>
<li><p>https://course.fast.ai/Lessons/lesson2.html</p></li>
<li><p>This is a minimal example showing how to train a fastai model on Kaggle, and save it so you can use it in your app.</p></li>
</ul>
<div id="cell-40" class="cell" data-executioninfo="{&quot;elapsed&quot;:27527,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774641367,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="4ccba017-aac2-4fe5-9639-b718da8c01fd">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>Uqq gradio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.0/17.0 MB 48.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 92.1/92.1 kB 7.2 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 310.7/310.7 kB 16.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 75.6/75.6 kB 7.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 138.5/138.5 kB 992.3 kB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.6/8.6 MB 48.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.6/60.6 kB 9.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.9/129.9 kB 19.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 77.8/77.8 kB 4.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.3/58.3 kB 9.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.5/71.5 kB 11.3 MB/s eta 0:00:00
  Building wheel for ffmpy (setup.py) ... done</code></pre>
</div>
</div>
<p>::: {#cell-41 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}</p>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gradio <span class="im">as</span> gr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>Download and decompress our dataset, which is pictures of dogs and cats:</p>
<div id="cell-43" class="cell" data-executioninfo="{&quot;elapsed&quot;:71649,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774723848,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="87cd1ca9-4ae6-4d0f-b8ea-919f7c582a38">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">"images"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="811712512" class="" max="811706944" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [811712512/811706944 00:59&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-44" class="cell" data-executioninfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774723849,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="8faddb29-7486-490a-90bf-58b764991642">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Path('/root/.fastai/data/oxford-iiit-pet/images')</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774723849,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="7f6faede-cbac-465f-9f06-468fadd47a66">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>get_image_files(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(#7390) [Path('/root/.fastai/data/oxford-iiit-pet/images/Maine_Coon_123.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/British_Shorthair_205.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/Sphynx_213.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/samoyed_36.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/samoyed_202.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/newfoundland_5.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/Bombay_170.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/japanese_chin_118.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/basset_hound_106.jpg'),Path('/root/.fastai/data/oxford-iiit-pet/images/staffordshire_bull_terrier_17.jpg')...]</code></pre>
</div>
</div>
<p>We need a way to label our images as dogs or cats. In this dataset, pictures of cats are given a filename that starts with a capital letter:</p>
<p>::: {#cell-47 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}</p>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_cat(x): <span class="cf">return</span> x.name[<span class="dv">0</span>].isupper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>Now we create our <code>DataLoaders</code>:</p>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                get_items<span class="op">=</span>get_image_files,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                splitter<span class="op">=</span>RandomSplitter(valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                get_y<span class="op">=</span>is_cat, item_tfms<span class="op">=</span>Resize(<span class="dv">192</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-executioninfo="{&quot;elapsed&quot;:4796,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774730464,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="1efe1769-6ca4-4699-f24e-e48545868968">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-51" class="cell" data-executioninfo="{&quot;elapsed&quot;:573,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774731031,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="1bd9c34a-5928-4544-b572-9ab052e21419">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
100%|██████████| 44.7M/44.7M [00:00&lt;00:00, 160MB/s]</code></pre>
</div>
</div>
<div id="cell-52" class="cell" data-executioninfo="{&quot;elapsed&quot;:154608,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710774885632,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="565c9c9c-3995-4bb7-89e6-f9f554e88b19">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.212446</td>
<td>0.038725</td>
<td>0.014885</td>
<td>00:38</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.069703</td>
<td>0.039434</td>
<td>0.012855</td>
<td>00:39</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.033530</td>
<td>0.036350</td>
<td>0.011502</td>
<td>00:39</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.020604</td>
<td>0.020321</td>
<td>0.006766</td>
<td>00:39</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now we can export our trained <code>Learner</code>. This contains all the information needed to run the model:</p>
<div id="cell-54" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>learn.export(<span class="st">"model.pkl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>::: {#cell-55 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’}</p>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> load_learner(<span class="st">"model.pkl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<div id="cell-56" class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710770510617,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="f5bcd145-b3a6-4856-86a9-a28ee0e15c51">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> PILImage.create(get_image_files(path)[<span class="dv">0</span>])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>im</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-57" class="cell" data-executioninfo="{&quot;elapsed&quot;:365,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710770515943,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="6de984e7-ec26-4f00-c5a0-6f389e0166f6">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>learn.predict(im)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>('True', tensor(1), tensor([1.0184e-17, 1.0000e+00]))</code></pre>
</div>
</div>
<div id="cell-58" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> (<span class="st">"Dog"</span>, <span class="st">"Cat"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_image(img):</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  pred, idx, probs <span class="op">=</span> learn.predict(img)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">dict</span>(<span class="bu">zip</span>(categories, <span class="bu">map</span>(<span class="bu">float</span>, probs)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-59" class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710770556015,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="0a456070-f872-434b-e791-7811136332c7">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>classify_image(im)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>{'Dog': 1.0184082265630366e-17, 'Cat': 1.0}</code></pre>
</div>
</div>
<p>::: {#cell-60 .cell 0=‘e’ 1=‘x’ 2=‘p’ 3=‘o’ 4=‘r’ 5=‘t’ executionInfo=‘{“elapsed”:18423,“status”:“ok”,“timestamp”:1710771017428,“user”:{“displayName”:“Afonso Matoso Magalhães”,“userId”:“00834841139025641156”},“user_tz”:0}’ outputId=‘04e918dc-4fd5-4d57-ee38-5435d17c2508’}</p>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> gr.Image(width<span class="op">=</span><span class="dv">192</span>, height<span class="op">=</span><span class="dv">192</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> gr.Label()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>examples <span class="op">=</span> [<span class="st">"cat.jpg"</span>, <span class="st">"dog.jpg"</span>, <span class="st">"dunno.jpg"</span>]</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>intf <span class="op">=</span> gr.Interface(fn<span class="op">=</span>classify_image, inputs<span class="op">=</span>image, outputs<span class="op">=</span>label, examples<span class="op">=</span>examples)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>intf.launch(inline<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Setting queue=True in a Colab notebook requires sharing enabled. Setting `share=True` (you can turn this off by setting `share=False` in `launch()` explicitly).

Colab notebook detected. To show errors in colab notebook, set debug=True in launch()
Running on public URL: https://1055565987c81c5615.gradio.live

This share link expires in 72 hours. For free permanent hosting and GPU upgrades, run `gradio deploy` from Terminal to deploy to Spaces (https://huggingface.co/spaces)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code></code></pre>
</div>
<p>:::</p>
<div id="cell-61" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nbdev.export <span class="im">import</span> notebook2script</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>notebbok2script(<span class="st">"app.ipynb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lesson-3" class="level1">
<h1>Lesson 3</h1>
<ul>
<li>https://course.fast.ai/Lessons/lesson3.html</li>
</ul>
<section id="timm" class="level2">
<h2 class="anchored" data-anchor-id="timm">timm</h2>
<p><a href="https://timm.fast.ai/">PyTorch Image Models</a> (timm) is a wonderful library by Ross Wightman which provides state-of-the-art pre-trained computer vision models. It’s like Huggingface Transformers, but for computer vision instead of NLP (and it’s not restricted to transformers-based models)!</p>
<p>Ross has been kind enough to help me understand how to best take advantage of this library by identifying the top models. I’m going to share here so of what I’ve learned from him, plus some additional ideas.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<p>Ross regularly benchmarks new models as they are added to timm, and puts the results in a CSV in the project’s GitHub repo. To analyse the data, we’ll first clone the repo:</p>
<div id="cell-66" class="cell" data-executioninfo="{&quot;elapsed&quot;:925,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785605571,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="1bd8d4ca-c701-4b6b-f7e1-5ab596bb9030" data-execution_count="5">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> git clone <span class="op">--</span>depth <span class="dv">1</span> https:<span class="op">//</span>github.com<span class="op">/</span>rwightman<span class="op">/</span>pytorch<span class="op">-</span>image<span class="op">-</span>models.git</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd pytorch<span class="op">-</span>image<span class="op">-</span>models<span class="op">/</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fatal: destination path 'pytorch-image-models' already exists and is not an empty directory.
/content/drive/MyDrive/fastai course/Aula 1, 2 e 3.1/pytorch-image-models/results</code></pre>
</div>
</div>
<p>Using Pandas, we can read the two CSV files we need, and merge them together.</p>
<div id="cell-68" class="cell" data-executioninfo="{&quot;elapsed&quot;:683,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785609220,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>df_results <span class="op">=</span> pd.read_csv(<span class="st">'results-imagenet.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785609501,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_results[<span class="st">'model_org'</span>] <span class="op">=</span> df_results[<span class="st">'model'</span>]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df_results[<span class="st">'model'</span>] <span class="op">=</span> df_results[<span class="st">'model'</span>].<span class="bu">str</span>.split(<span class="st">'.'</span>).<span class="bu">str</span>[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll also add a “family” column that will allow us to group architectures into categories with similar characteristics:</p>
<p>Ross has told me which models he’s found the most usable in practice, so I’ll limit the charts to just look at these. (I also include VGG, not because it’s good, but as a comparison to show how far things have come in the last few years.)</p>
<div id="cell-71" class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785611348,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_data(part, col):</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(<span class="ss">f'benchmark-</span><span class="sc">{</span>part<span class="sc">}</span><span class="ss">-amp-nhwc-pt111-cu113-rtx3090.csv'</span>).merge(df_results, on<span class="op">=</span><span class="st">'model'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'secs'</span>] <span class="op">=</span> <span class="fl">1.</span> <span class="op">/</span> df[col]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'family'</span>] <span class="op">=</span> df.model.<span class="bu">str</span>.extract(<span class="st">'^([a-z]+?(?:v2)?)(?:\d|_|$)'</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[<span class="op">~</span>df.model.<span class="bu">str</span>.endswith(<span class="st">'gn'</span>)]</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    df.loc[df.model.<span class="bu">str</span>.contains(<span class="st">'in22'</span>),<span class="st">'family'</span>] <span class="op">=</span> df.loc[df.model.<span class="bu">str</span>.contains(<span class="st">'in22'</span>),<span class="st">'family'</span>] <span class="op">+</span> <span class="st">'_in22'</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    df.loc[df.model.<span class="bu">str</span>.contains(<span class="st">'resnet.*d'</span>),<span class="st">'family'</span>] <span class="op">=</span> df.loc[df.model.<span class="bu">str</span>.contains(<span class="st">'resnet.*d'</span>),<span class="st">'family'</span>] <span class="op">+</span> <span class="st">'d'</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[df.family.<span class="bu">str</span>.contains(<span class="st">'^re[sg]netd?|beit|convnext|levit|efficient|vit|vgg|swin'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-72" class="cell" data-executioninfo="{&quot;elapsed&quot;:583,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785614407,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> get_data(<span class="st">'infer'</span>, <span class="st">'infer_samples_per_sec'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inference-results" class="level2">
<h2 class="anchored" data-anchor-id="inference-results">Inference results</h2>
<p>Here’s the results for inference performance (see the last section for training performance). In this chart:</p>
<ul>
<li>the x axis shows how many seconds it takes to process one image (<strong>note</strong>: it’s a log scale)</li>
<li>the y axis is the accuracy on Imagenet</li>
<li>the size of each bubble is proportional to the size of images used in testing</li>
<li>the color shows what “family” the architecture is from.</li>
</ul>
<p>Hover your mouse over a marker to see details about the model. Double-click in the legend to display just one family. Single-click in the legend to show or hide a family.</p>
<p><strong>Note</strong>: on my screen, Kaggle cuts off the family selector and some plotly functionality – to see the whole thing, collapse the table of contents on the right by clicking the little arrow to the right of “<em>Contents</em>”.</p>
<div id="cell-75" class="cell" data-executioninfo="{&quot;elapsed&quot;:600,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785617884,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>w,h <span class="op">=</span> <span class="dv">1000</span>,<span class="dv">800</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_all(df, title, size):</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> px.scatter(df, width<span class="op">=</span>w, height<span class="op">=</span>h, size<span class="op">=</span>df[size]<span class="op">**</span><span class="dv">2</span>, title<span class="op">=</span>title,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'secs'</span>,  y<span class="op">=</span><span class="st">'top1'</span>, log_x<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'family'</span>, hover_name<span class="op">=</span><span class="st">'model_org'</span>, hover_data<span class="op">=</span>[size])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-76" class="cell" data-executioninfo="{&quot;elapsed&quot;:1254,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785619137,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="3d1b9700-6f05-422a-80e8-b7291fb3d692" data-execution_count="11">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>show_all(df, <span class="st">'Inference'</span>, <span class="st">'infer_img_size'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="3f74149f-b425-4cf3-8742-907e0d0018a6" class="plotly-graph-div" style="height:800px; width:1000px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3f74149f-b425-4cf3-8742-907e0d0018a6")) {                    Plotly.newPlot(                        "3f74149f-b425-4cf3-8742-907e0d0018a6",                        [{"customdata":[[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["levit_128s.fb_dist_in1k","levit_128.fb_dist_in1k","levit_192.fb_dist_in1k","levit_256.fb_dist_in1k","levit_384.fb_dist_in1k"],"legendgroup":"levit","marker":{"color":"#636efa","size":[50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"levit","orientation":"v","showlegend":true,"x":[4.654236751715086e-05,6.822292249261998e-05,7.756230968148262e-05,0.00010599687945186893,0.00017720128293728847],"xaxis":"x","y":[76.526,78.49,79.838,81.524,82.596],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetx_002.pycls_in1k","regnetx_004.pycls_in1k","regnetx_008.tv2_in1k","regnetx_008.pycls_in1k","regnetx_006.pycls_in1k","regnetx_016.tv2_in1k","regnetx_016.pycls_in1k","regnetx_032.tv2_in1k","regnetx_032.pycls_in1k","regnetx_040.pycls_in1k","regnetx_080.tv2_in1k","regnetx_080.pycls_in1k","regnetx_064.pycls_in1k","regnetx_120.pycls_in1k","regnetx_160.tv2_in1k","regnetx_160.pycls_in1k","regnetx_320.tv2_in1k","regnetx_320.pycls_in1k"],"legendgroup":"regnetx","marker":{"color":"#EF553B","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetx","orientation":"v","showlegend":true,"x":[5.611048828469115e-05,6.925193368711838e-05,0.00011822399190402103,0.00011822399190402103,0.0001259786970023369,0.00026479614668647344,0.00026479614668647344,0.0006228278877415016,0.0006228278877415016,0.0006304057291272663,0.0007938902208602596,0.0007938902208602596,0.0008572212316554657,0.0012854296548621376,0.001604157977477622,0.001604157977477622,0.0038134462113411888,0.0038134462113411888],"xaxis":"x","y":[68.752,72.402,77.306,75.028,73.868,79.436,76.924,80.926,78.168,78.492,81.54,79.198,79.066,79.588,82.566,79.866,82.81,80.246],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[288],[288],[288],[288],[288],[224],[224],[288],[288],[288],[288],[224],[224],[224],[224],[224],[288],[288],[288],[288],[288],[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnety\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnety_002.pycls_in1k","regnety_006.pycls_in1k","regnety_004.tv2_in1k","regnety_004.pycls_in1k","regnety_008.pycls_in1k","regnety_016.tv2_in1k","regnety_016.pycls_in1k","regnety_032.ra_in1k","regnety_032.tv2_in1k","regnety_032.pycls_in1k","regnety_040.ra3_in1k","regnety_040.pycls_in1k","regnety_120.sw_in12k_ft_in1k","regnety_120.pycls_in1k","regnety_080.ra3_in1k","regnety_080.pycls_in1k","regnety_064.ra3_in1k","regnety_064.pycls_in1k","regnety_320.swag_ft_in1k","regnety_320.swag_lc_in1k","regnety_320.seer_ft_in1k","regnety_320.tv2_in1k","regnety_320.pycls_in1k","regnety_160.swag_ft_in1k","regnety_160.lion_in12k_ft_in1k","regnety_160.sw_in12k_ft_in1k","regnety_160.swag_lc_in1k","regnety_160.deit_in1k","regnety_160.tv2_in1k","regnety_160.pycls_in1k"],"legendgroup":"regnety","marker":{"color":"#00cc96","size":[50176,50176,50176,50176,50176,50176,50176,82944,82944,82944,82944,82944,50176,50176,82944,82944,82944,82944,50176,50176,50176,50176,50176,82944,82944,82944,82944,82944,82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnety","orientation":"v","showlegend":true,"x":[5.9976920880845045e-05,0.00010017450398594352,0.00010468376082691796,0.00010468376082691796,0.00012704688411164372,0.00029335406368716726,0.00029335406368716726,0.0007311277645768598,0.0007311277645768598,0.0007311277645768598,0.0011773986554107355,0.0011773986554107355,0.0013256445946841651,0.0013256445946841651,0.0018643499011894553,0.0018643499011894553,0.0021192726656211586,0.0021192726656211586,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875],"xaxis":"x","y":[70.28,75.268,75.594,74.026,76.302,80.666,77.868,82.726,81.756,78.876,83.044,79.22,85.4,80.38,83.926,79.868,83.72,79.716,86.834,84.548,83.328,83.162,80.81,86.02,85.988,85.986,83.782,83.69,82.646,80.298],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[384],[224],[224],[384],[224],[384],[384],[384],[224],[224],[224],[224],[224],[224],[224],[384],[384],[384],[384],[224],[384],[384],[384],[384],[224],[224],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vit_small_patch32_224.augreg_in21k_ft_in1k","vit_tiny_r_s16_p8_224.augreg_in21k_ft_in1k","vit_tiny_patch16_224.augreg_in21k_ft_in1k","vit_base_patch32_224.augreg_in21k_ft_in1k","vit_base_patch32_224.augreg_in1k","vit_base_patch32_224.sam_in1k","vit_small_patch32_384.augreg_in21k_ft_in1k","vit_small_patch16_224.augreg_in21k_ft_in1k","vit_small_patch16_224.augreg_in1k","vit_tiny_r_s16_p8_384.augreg_in21k_ft_in1k","vit_small_r26_s32_224.augreg_in21k_ft_in1k","vit_tiny_patch16_384.augreg_in21k_ft_in1k","vit_base_patch32_384.augreg_in21k_ft_in1k","vit_base_patch32_384.augreg_in1k","vit_base_patch16_224_miil.in21k_ft_in1k","vit_base_patch16_224.augreg2_in21k_ft_in1k","vit_base_patch16_224.augreg_in21k_ft_in1k","vit_base_patch16_224.orig_in21k_ft_in1k","vit_base_patch16_224.sam_in1k","vit_base_patch16_224.augreg_in1k","vit_large_r50_s32_224.augreg_in21k_ft_in1k","vit_small_patch16_384.augreg_in21k_ft_in1k","vit_small_patch16_384.augreg_in1k","vit_small_r26_s32_384.augreg_in21k_ft_in1k","vit_large_patch32_384.orig_in21k_ft_in1k","vit_large_patch16_224.augreg_in21k_ft_in1k","vit_base_patch16_384.augreg_in21k_ft_in1k","vit_base_patch16_384.orig_in21k_ft_in1k","vit_base_patch16_384.augreg_in1k","vit_large_r50_s32_384.augreg_in21k_ft_in1k","vit_base_patch8_224.augreg2_in21k_ft_in1k","vit_base_patch8_224.augreg_in21k_ft_in1k","vit_base_r50_s16_384.orig_in21k_ft_in1k","vit_large_patch16_384.augreg_in21k_ft_in1k"],"legendgroup":"vit","marker":{"color":"#ab63fa","size":[50176,50176,50176,50176,50176,50176,147456,50176,50176,147456,50176,147456,147456,147456,50176,50176,50176,50176,50176,50176,50176,147456,147456,147456,147456,50176,147456,147456,147456,147456,50176,50176,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vit","orientation":"v","showlegend":true,"x":[8.26542597112556e-05,0.00010105327831992861,0.0001606500543800434,0.00023169601482854495,0.00023169601482854495,0.00023169601482854495,0.0002629917946560067,0.0003523347461956656,0.0003523347461956656,0.0003702675182819587,0.0005623284898106078,0.0006846126461648,0.0007257578726585237,0.0007257578726585237,0.0009018027036045053,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.0013855980934170233,0.0014628865677755345,0.0014628865677755345,0.0017152952880838436,0.002085723224528105,0.0028202380280895707,0.0036026948157221604,0.0036026948157221604,0.0036026948157221604,0.004231729507849859,0.005465078150617554,0.005465078150617554,0.005822416302765648,0.010594342621040365],"xaxis":"x","y":[75.994,71.798,75.462,80.716,74.894,73.694,80.486,81.386,78.848,75.96,81.864,78.424,83.352,78.756,84.266,85.094,84.532,81.79,80.238,79.154,84.418,83.804,81.116,84.048,81.51,85.836,85.994,84.2,81.102,86.182,86.218,85.798,84.976,87.084],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[256],[224],[224],[224],[224],[224],[224],[224],[288],[288],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18.fb_swsl_ig1b_ft_in1k","resnet18.a1_in1k","resnet18.fb_ssl_yfcc100m_ft_in1k","resnet18.a2_in1k","resnet18.gluon_in1k","resnet18.tv_in1k","resnet18.a3_in1k","resnet34.a1_in1k","resnet34.a2_in1k","resnet34.bt_in1k","resnet34.gluon_in1k","resnet34.tv_in1k","resnet34.a3_in1k","resnet26.bt_in1k","resnet26t.ra2_in1k","resnet50.a1_in1k","resnet50.fb_swsl_ig1b_ft_in1k","resnet50.d_in1k","resnet50.c1_in1k","resnet50.c2_in1k","resnet50.tv2_in1k","resnet50.a2_in1k","resnet50.b1k_in1k","resnet50.a1h_in1k","resnet50.b2k_in1k","resnet50.ram_in1k","resnet50.ra_in1k","resnet50.bt_in1k","resnet50.fb_ssl_yfcc100m_ft_in1k","resnet50.am_in1k","resnet50.a3_in1k","resnet50.gluon_in1k","resnet50.tv_in1k","resnet32ts.ra2_in1k","resnet33ts.ra2_in1k","resnet101.a1h_in1k","resnet101.a1_in1k","resnet101.a2_in1k","resnet101.tv2_in1k","resnet101.a3_in1k","resnet101.gluon_in1k","resnet101.tv_in1k","resnet51q.ra2_in1k","resnet61q.ra2_in1k","resnet152.a1h_in1k","resnet152.a1_in1k","resnet152.a2_in1k","resnet152.tv2_in1k","resnet152.a3_in1k","resnet152.gluon_in1k","resnet152.tv_in1k"],"legendgroup":"resnet","marker":{"color":"#FFA15A","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,65536,50176,50176,50176,50176,50176,50176,50176,82944,82944,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnet","orientation":"v","showlegend":true,"x":[9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00017561482751111642,0.0002638710409448694,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00029286350217890445,0.00029674294938752255,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.000534896657965681,0.0005959830740806961,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052],"xaxis":"x","y":[73.288,73.158,72.598,72.372,70.834,69.76,68.252,77.918,77.158,76.48,74.58,73.306,72.97,76.366,78.328,81.214,81.172,80.972,80.912,80.87,80.848,80.772,80.706,80.678,80.454,79.976,79.836,79.64,79.23,79.002,78.048,77.582,76.128,79.388,79.726,82.778,82.322,82.236,81.888,79.814,79.31,77.38,82.36,82.524,83.45,82.732,82.608,82.286,80.546,79.696,78.322],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[240],[224],[224],[256],[260],[240],[288],[300],[320],[300],[300],[384],[456]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnet_lite0.ra_in1k","efficientnet_b0.ra_in1k","efficientnet_b1_pruned.in1k","efficientnet_es.ra_in1k","efficientnet_es_pruned.in1k","efficientnet_b1.ft_in1k","efficientnet_b2_pruned.in1k","efficientnet_em.ra2_in1k","efficientnet_b2.ra_in1k","efficientnet_b3_pruned.in1k","efficientnet_b3.ra2_in1k","efficientnet_el.ra_in1k","efficientnet_el_pruned.in1k","efficientnet_b4.ra2_in1k","efficientnet_b5.sw_in12k_ft_in1k"],"legendgroup":"efficientnet","marker":{"color":"#19d3f3","size":[50176,50176,57600,50176,50176,65536,67600,57600,82944,90000,102400,90000,90000,147456,207936],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnet","orientation":"v","showlegend":true,"x":[0.00011112172940969915,0.0001301779923689661,0.00016600486062231902,0.00017507769072525934,0.00017510804166170527,0.00024378530315921374,0.0002616848842960284,0.0002911538719097656,0.00032120258246876303,0.00032275451614256713,0.000539647933688062,0.0006642355645005945,0.0006644474123095528,0.0010264938051098862,0.0021380313007782433],"xaxis":"x","y":[75.482,77.694,78.24,78.058,75.006,78.8,79.92,79.244,80.61,80.852,82.246,81.312,80.298,83.414,85.896],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18d.ra2_in1k","resnet34d.ra2_in1k","resnet26d.bt_in1k","resnet50d.a1_in1k","resnet50d.ra2_in1k","resnet50d.a2_in1k","resnet50d.gluon_in1k","resnet50d.a3_in1k","resnet101d.ra2_in1k","resnet101d.gluon_in1k","resnet152d.ra2_in1k","resnet152d.gluon_in1k","resnet200d.ra2_in1k"],"legendgroup":"resnetd","marker":{"color":"#FF6692","size":[50176,50176,50176,50176,50176,50176,50176,50176,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetd","orientation":"v","showlegend":true,"x":[0.00011218547400045547,0.00017947263760167124,0.0002044542400742578,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.0010008807750820723,0.0010008807750820723,0.0014054023666975855,0.0014054023666975855,0.0019066503965832825],"xaxis":"x","y":[73.794,78.436,77.408,81.45,81.356,81.164,79.078,78.72,83.02,80.426,83.684,80.476,83.964],"yaxis":"y","type":"scatter"},{"customdata":[[256],[256],[256]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=mobilevit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["mobilevit_xxs.cvnets_in1k","mobilevit_xs.cvnets_in1k","mobilevit_s.cvnets_in1k"],"legendgroup":"mobilevit","marker":{"color":"#B6E880","size":[65536,65536,65536],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"mobilevit","orientation":"v","showlegend":true,"x":[0.00019510063290645313,0.00032276493352656195,0.0004140683875348853],"xaxis":"x","y":[68.918,74.634,78.312],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=repvgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["repvgg_b0.rvgg_in1k","repvgg_a2.rvgg_in1k","repvgg_b1.rvgg_in1k","repvgg_b1g4.rvgg_in1k","repvgg_b2.rvgg_in1k","repvgg_b3.rvgg_in1k","repvgg_b2g4.rvgg_in1k","repvgg_b3g4.rvgg_in1k"],"legendgroup":"repvgg","marker":{"color":"#FF97FF","size":[50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"repvgg","orientation":"v","showlegend":true,"x":[0.00019805588344807372,0.00025848743492578826,0.0005164995790528431,0.0006192755714365336,0.0008039813154742284,0.0009981932701809725,0.0012302090125112257,0.0015526503741887404],"xaxis":"x","y":[75.144,76.458,78.368,77.588,78.792,80.506,79.382,80.216],"yaxis":"y","type":"scatter"},{"customdata":[[240],[240],[240],[240],[240],[240],[240],[240],[240],[408],[408]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=crossvit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["crossvit_tiny_240.in1k","crossvit_9_240.in1k","crossvit_9_dagger_240.in1k","crossvit_small_240.in1k","crossvit_15_240.in1k","crossvit_15_dagger_240.in1k","crossvit_18_240.in1k","crossvit_18_dagger_240.in1k","crossvit_base_240.in1k","crossvit_15_dagger_408.in1k","crossvit_18_dagger_408.in1k"],"legendgroup":"crossvit","marker":{"color":"#FECB52","size":[57600,57600,57600,57600,57600,57600,57600,57600,57600,166464,166464],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"crossvit","orientation":"v","showlegend":true,"x":[0.00025943432938820195,0.0002746551018558445,0.0002807190900209978,0.0005422640609070993,0.0005881107530170082,0.0006054331571522846,0.0008294969101240098,0.0008531185749507324,0.0013383297644539614,0.002823662289990117,0.0038593647485623862],"xaxis":"x","y":[73.34,73.96,76.978,81.018,81.536,82.33,82.4,82.518,82.214,83.84,84.202],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetv2_50.a1h_in1k","resnetv2_101.a1h_in1k"],"legendgroup":"resnetv2","marker":{"color":"#636efa","size":[50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetv2","orientation":"v","showlegend":true,"x":[0.00027003891260730673,0.0004473172150030194],"xaxis":"x","y":[81.398,83.0],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convit_tiny.fb_in1k","convit_small.fb_in1k","convit_base.fb_in1k"],"legendgroup":"convit","marker":{"color":"#EF553B","size":[50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convit","orientation":"v","showlegend":true,"x":[0.0003142578800163414,0.0007307163943530237,0.0014544608313698112],"xaxis":"x","y":[73.112,81.42,82.29],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetaad\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetaa50d.sw_in12k_ft_in1k","resnetaa101d.sw_in12k_ft_in1k"],"legendgroup":"resnetaad","marker":{"color":"#00cc96","size":[50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetaad","orientation":"v","showlegend":true,"x":[0.00034852799202567954,0.0005280918457338101],"xaxis":"x","y":[82.6,84.124],"yaxis":"y","type":"scatter"},{"customdata":[[224],[288],[320],[320],[352],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetrs\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetrs50.tf_in1k","resnetrs101.tf_in1k","resnetrs152.tf_in1k","resnetrs200.tf_in1k","resnetrs270.tf_in1k","resnetrs350.tf_in1k","resnetrs420.tf_in1k"],"legendgroup":"resnetrs","marker":{"color":"#ab63fa","size":[50176,82944,102400,102400,123904,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetrs","orientation":"v","showlegend":true,"x":[0.000351576645466595,0.0009125586318920991,0.0015921792156925183,0.0021917327839389824,0.0034781398907864076,0.005297171310520182,0.007450454477723141],"xaxis":"x","y":[79.894,82.284,83.702,84.444,84.428,84.714,85.004],"yaxis":"y","type":"scatter"},{"customdata":[[288],[320],[320],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetz\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetz_b16.ra3_in1k","regnetz_c16.ra3_in1k","regnetz_d8.ra3_in1k","regnetz_040.ra3_in1k","regnetz_d32.ra3_in1k","regnetz_e8.ra3_in1k","regnetz_c16_evos.ch_in1k","regnetz_d8_evos.ch_in1k"],"legendgroup":"regnetz","marker":{"color":"#FFA15A","size":[82944,102400,102400,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetz","orientation":"v","showlegend":true,"x":[0.00036824952587873543,0.0005641494319015222,0.0008748829844008363,0.000961917679085024,0.0009901872444079175,0.0016463344363774057,0.00167117884956048,0.002579646588417387],"xaxis":"x","y":[80.728,82.632,84.052,84.24,84.022,85.034,82.636,84.126],"yaxis":"y","type":"scatter"},{"customdata":[[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetblur\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetblur50.bt_in1k"],"legendgroup":"resnetblur","marker":{"color":"#19d3f3","size":[50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetblur","orientation":"v","showlegend":true,"x":[0.00038181346121538863],"xaxis":"x","y":[80.234],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vgg11_bn.tv_in1k","vgg13.tv_in1k","vgg13_bn.tv_in1k","vgg16.tv_in1k","vgg19.tv_in1k","vgg16_bn.tv_in1k","vgg19_bn.tv_in1k"],"legendgroup":"vgg","marker":{"color":"#FF6692","size":[50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vgg","orientation":"v","showlegend":true,"x":[0.0003856239395341663,0.000495051955702751,0.000609002271578473,0.00061273383454961,0.0007314379338341244,0.0007335465508641178,0.0008591212907438273],"xaxis":"x","y":[70.382,69.932,71.588,71.592,72.378,73.37,74.216],"yaxis":"y","type":"scatter"},{"customdata":[[288],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnetv2_rw_t.ra2_in1k","efficientnetv2_rw_s.ra2_in1k","efficientnetv2_rw_m.agc_in1k"],"legendgroup":"efficientnetv2","marker":{"color":"#B6E880","size":[82944,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnetv2","orientation":"v","showlegend":true,"x":[0.00039287790926091805,0.0009177342975661686,0.0025433643623785545],"xaxis":"x","y":[82.35,83.806,84.81],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convnext_tiny.in12k_ft_in1k_384","convnext_tiny.in12k_ft_in1k","convnext_tiny.fb_in22k_ft_in1k_384","convnext_tiny.fb_in1k","convnext_tiny.fb_in22k_ft_in1k","convnext_tiny_hnf.a2h_in1k","convnext_small.in12k_ft_in1k_384","convnext_small.fb_in22k_ft_in1k_384","convnext_small.in12k_ft_in1k","convnext_small.fb_in22k_ft_in1k","convnext_small.fb_in1k","convnext_base.clip_laion2b_augreg_ft_in12k_in1k_384","convnext_base.fb_in22k_ft_in1k_384","convnext_base.clip_laiona_augreg_ft_in1k_384","convnext_base.clip_laion2b_augreg_ft_in12k_in1k","convnext_base.fb_in22k_ft_in1k","convnext_base.clip_laion2b_augreg_ft_in1k","convnext_base.fb_in1k","convnext_large.fb_in22k_ft_in1k_384","convnext_large.fb_in22k_ft_in1k","convnext_large.fb_in1k"],"legendgroup":"convnext","marker":{"color":"#FF97FF","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convnext","orientation":"v","showlegend":true,"x":[0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00048231356169272765,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001837424665588711,0.001837424665588711,0.001837424665588711],"xaxis":"x","y":[85.122,84.45,84.088,82.698,78.898,82.584,86.182,85.778,85.33,85.262,83.7,87.134,86.796,86.502,86.37,86.274,86.158,84.428,87.472,87.026,84.846],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[384],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["swin_tiny_patch4_window7_224.ms_in1k","swin_tiny_patch4_window7_224.ms_in22k_ft_in1k","swin_s3_tiny_224.ms_in1k","swin_small_patch4_window7_224.ms_in22k_ft_in1k","swin_small_patch4_window7_224.ms_in1k","swin_s3_small_224.ms_in1k","swin_base_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window7_224.ms_in1k","swin_s3_base_224.ms_in1k","swin_large_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in1k","swin_large_patch4_window12_384.ms_in22k_ft_in1k"],"legendgroup":"swin","marker":{"color":"#FECB52","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,147456,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"swin","orientation":"v","showlegend":true,"x":[0.0005460184335823177,0.0005460184335823177,0.000599319173418996,0.0008899409969119047,0.0008899409969119047,0.0012179822905374956,0.001254390366281987,0.001254390366281987,0.001502765087761481,0.002185123678000175,0.004700352526439483,0.004700352526439483,0.007950389569088886],"xaxis":"x","y":[81.376,80.968,82.144,83.298,83.208,83.756,85.272,83.606,83.92,86.312,86.438,84.476,87.132],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[384],[384],[512]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["beit_base_patch16_224.in22k_ft_in22k_in1k","beit_large_patch16_224.in22k_ft_in22k_in1k","beit_base_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_512.in22k_ft_in22k_in1k"],"legendgroup":"beit","marker":{"color":"#636efa","size":[50176,50176,147456,147456,262144],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"beit","orientation":"v","showlegend":true,"x":[0.0010062791820962809,0.0030446034404018876,0.00418007774944614,0.0121580547112462,0.030184123151222455],"xaxis":"x","y":[85.212,87.478,86.8,88.402,88.596],"yaxis":"y","type":"scatter"},{"customdata":[[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetv\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetv_040.ra3_in1k","regnetv_064.ra3_in1k"],"legendgroup":"regnetv","marker":{"color":"#EF553B","size":[82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetv","orientation":"v","showlegend":true,"x":[0.0011776343680813981,0.0021355201059217975],"xaxis":"x","y":[83.19,83.716],"yaxis":"y","type":"scatter"},{"customdata":[[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetv2d\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetv2_50d_evos.ah_in1k"],"legendgroup":"resnetv2d","marker":{"color":"#00cc96","size":[82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetv2d","orientation":"v","showlegend":true,"x":[0.0011976191331632715],"xaxis":"x","y":[82.002],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"secs"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"top1"}},"legend":{"title":{"text":"family"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"Inference"},"height":800,"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3f74149f-b425-4cf3-8742-907e0d0018a6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
<p>That number of families can be a bit overwhelming, so I’ll just pick a subset which represents a single key model from each of the families that are looking best in our plot. I’ve also separated convnext models into those which have been pretrained on the larger 22,000 category imagenet sample (<code>convnext_in22</code>) vs those that haven’t (<code>convnext</code>). (Note that many of the best performing models were trained on the larger sample – see the papers for details before coming to conclusions about the effectiveness of these architectures more generally.)</p>
<div id="cell-78" class="cell" data-executioninfo="{&quot;elapsed&quot;:240,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785621932,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>subs <span class="op">=</span> <span class="st">'levit|resnetd?|regnetx|vgg|convnext.*|efficientnetv2|beit|swin'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this chart, I’ll add lines through the points of each family, to help see how they compare – but note that we can see that a linear fit isn’t actually ideal here! It’s just there to help visually see the groups.</p>
<div id="cell-80" class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785623998,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_subs(df, title, size):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    df_subs <span class="op">=</span> df[df.family.<span class="bu">str</span>.fullmatch(subs)]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> px.scatter(df_subs, width<span class="op">=</span>w, height<span class="op">=</span>h, size<span class="op">=</span>df_subs[size]<span class="op">**</span><span class="dv">2</span>, title<span class="op">=</span>title,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>        trendline<span class="op">=</span><span class="st">"ols"</span>, trendline_options<span class="op">=</span>{<span class="st">'log_x'</span>:<span class="va">True</span>},</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'secs'</span>,  y<span class="op">=</span><span class="st">'top1'</span>, log_x<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'family'</span>, hover_name<span class="op">=</span><span class="st">'model_org'</span>, hover_data<span class="op">=</span>[size])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-81" class="cell" data-executioninfo="{&quot;elapsed&quot;:1797,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785626085,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="d58c9994-5c53-456f-f8ba-db695feca1fe" data-execution_count="14">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>show_subs(df, <span class="st">'Inference'</span>, <span class="st">'infer_img_size'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="be492901-4aba-41da-a2af-37c3df0e8a73" class="plotly-graph-div" style="height:800px; width:1000px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("be492901-4aba-41da-a2af-37c3df0e8a73")) {                    Plotly.newPlot(                        "be492901-4aba-41da-a2af-37c3df0e8a73",                        [{"customdata":[[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["levit_128s.fb_dist_in1k","levit_128.fb_dist_in1k","levit_192.fb_dist_in1k","levit_256.fb_dist_in1k","levit_384.fb_dist_in1k"],"legendgroup":"levit","marker":{"color":"#636efa","size":[50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"levit","orientation":"v","showlegend":true,"x":[4.654236751715086e-05,6.822292249261998e-05,7.756230968148262e-05,0.00010599687945186893,0.00017720128293728847],"xaxis":"x","y":[76.526,78.49,79.838,81.524,82.596],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 10.7211 * log10(secs) + 123.397\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.940450\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"levit","marker":{"color":"#636efa","symbol":"circle"},"mode":"lines","name":"levit","showlegend":false,"x":[4.654236751715086e-05,6.822292249261998e-05,7.756230968148262e-05,0.00010599687945186893,0.00017720128293728847],"xaxis":"x","y":[76.95168062867072,78.73225889138425,79.32964240073431,80.78387605941839,83.17654201979207],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetx_002.pycls_in1k","regnetx_004.pycls_in1k","regnetx_008.tv2_in1k","regnetx_008.pycls_in1k","regnetx_006.pycls_in1k","regnetx_016.tv2_in1k","regnetx_016.pycls_in1k","regnetx_032.tv2_in1k","regnetx_032.pycls_in1k","regnetx_040.pycls_in1k","regnetx_080.tv2_in1k","regnetx_080.pycls_in1k","regnetx_064.pycls_in1k","regnetx_120.pycls_in1k","regnetx_160.tv2_in1k","regnetx_160.pycls_in1k","regnetx_320.tv2_in1k","regnetx_320.pycls_in1k"],"legendgroup":"regnetx","marker":{"color":"#EF553B","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetx","orientation":"v","showlegend":true,"x":[5.611048828469115e-05,6.925193368711838e-05,0.00011822399190402103,0.00011822399190402103,0.0001259786970023369,0.00026479614668647344,0.00026479614668647344,0.0006228278877415016,0.0006228278877415016,0.0006304057291272663,0.0007938902208602596,0.0007938902208602596,0.0008572212316554657,0.0012854296548621376,0.001604157977477622,0.001604157977477622,0.0038134462113411888,0.0038134462113411888],"xaxis":"x","y":[68.752,72.402,77.306,75.028,73.868,79.436,76.924,80.926,78.168,78.492,81.54,79.198,79.066,79.588,82.566,79.866,82.81,80.246],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 5.6134 * log10(secs) + 96.6816\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.746680\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"regnetx","marker":{"color":"#EF553B","symbol":"circle"},"mode":"lines","name":"regnetx","showlegend":false,"x":[5.611048828469115e-05,6.925193368711838e-05,0.00011822399190402103,0.00011822399190402103,0.0001259786970023369,0.00026479614668647344,0.00026479614668647344,0.0006228278877415016,0.0006228278877415016,0.0006304057291272663,0.0007938902208602596,0.0007938902208602596,0.0008572212316554657,0.0012854296548621376,0.001604157977477622,0.001604157977477622,0.0038134462113411888,0.0038134462113411888],"xaxis":"x","y":[72.81925169231477,73.33224839493761,74.63609394413581,74.63609394413581,74.79097606197254,76.60194095584733,76.60194095584733,78.6870746955967,78.6870746955967,78.71655684599877,79.27868453111466,79.27868453111466,79.46579303991231,80.45350126867802,80.99350384267571,80.99350384267571,83.10453837872276,83.10453837872276],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[256],[224],[224],[224],[224],[224],[224],[224],[288],[288],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18.fb_swsl_ig1b_ft_in1k","resnet18.a1_in1k","resnet18.fb_ssl_yfcc100m_ft_in1k","resnet18.a2_in1k","resnet18.gluon_in1k","resnet18.tv_in1k","resnet18.a3_in1k","resnet34.a1_in1k","resnet34.a2_in1k","resnet34.bt_in1k","resnet34.gluon_in1k","resnet34.tv_in1k","resnet34.a3_in1k","resnet26.bt_in1k","resnet26t.ra2_in1k","resnet50.a1_in1k","resnet50.fb_swsl_ig1b_ft_in1k","resnet50.d_in1k","resnet50.c1_in1k","resnet50.c2_in1k","resnet50.tv2_in1k","resnet50.a2_in1k","resnet50.b1k_in1k","resnet50.a1h_in1k","resnet50.b2k_in1k","resnet50.ram_in1k","resnet50.ra_in1k","resnet50.bt_in1k","resnet50.fb_ssl_yfcc100m_ft_in1k","resnet50.am_in1k","resnet50.a3_in1k","resnet50.gluon_in1k","resnet50.tv_in1k","resnet32ts.ra2_in1k","resnet33ts.ra2_in1k","resnet101.a1h_in1k","resnet101.a1_in1k","resnet101.a2_in1k","resnet101.tv2_in1k","resnet101.a3_in1k","resnet101.gluon_in1k","resnet101.tv_in1k","resnet51q.ra2_in1k","resnet61q.ra2_in1k","resnet152.a1h_in1k","resnet152.a1_in1k","resnet152.a2_in1k","resnet152.tv2_in1k","resnet152.a3_in1k","resnet152.gluon_in1k","resnet152.tv_in1k"],"legendgroup":"resnet","marker":{"color":"#00cc96","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,65536,50176,50176,50176,50176,50176,50176,50176,82944,82944,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnet","orientation":"v","showlegend":true,"x":[9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00017561482751111642,0.0002638710409448694,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00029286350217890445,0.00029674294938752255,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.000534896657965681,0.0005959830740806961,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052],"xaxis":"x","y":[73.288,73.158,72.598,72.372,70.834,69.76,68.252,77.918,77.158,76.48,74.58,73.306,72.97,76.366,78.328,81.214,81.172,80.972,80.912,80.87,80.848,80.772,80.706,80.678,80.454,79.976,79.836,79.64,79.23,79.002,78.048,77.582,76.128,79.388,79.726,82.778,82.322,82.236,81.888,79.814,79.31,77.38,82.36,82.524,83.45,82.732,82.608,82.286,80.546,79.696,78.322],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 12.0263 * log10(secs) + 121.295\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.731925\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"resnet","marker":{"color":"#00cc96","symbol":"circle"},"mode":"lines","name":"resnet","showlegend":false,"x":[9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00017561482751111642,0.0002638710409448694,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00029286350217890445,0.00029674294938752255,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.000534896657965681,0.0005959830740806961,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052],"xaxis":"x","y":[72.77503159205096,72.77503159205096,72.77503159205096,72.77503159205096,72.77503159205096,72.77503159205096,72.77503159205096,75.63436893719161,75.63436893719161,75.63436893719161,75.63436893719161,75.63436893719161,75.63436893719161,76.13074551769509,78.25736330794714,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.63005651895239,78.80183639972724,78.87056861497342,81.16727708148389,81.16727708148389,81.16727708148389,81.16727708148389,81.16727708148389,81.16727708148389,81.16727708148389,81.94797302569253,82.51277682712737,83.07276351825747,83.07276351825747,83.07276351825747,83.07276351825747,83.07276351825747,83.07276351825747,83.07276351825747],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18d.ra2_in1k","resnet34d.ra2_in1k","resnet26d.bt_in1k","resnet50d.a1_in1k","resnet50d.ra2_in1k","resnet50d.a2_in1k","resnet50d.gluon_in1k","resnet50d.a3_in1k","resnet101d.ra2_in1k","resnet101d.gluon_in1k","resnet152d.ra2_in1k","resnet152d.gluon_in1k","resnet200d.ra2_in1k"],"legendgroup":"resnetd","marker":{"color":"#ab63fa","size":[50176,50176,50176,50176,50176,50176,50176,50176,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetd","orientation":"v","showlegend":true,"x":[0.00011218547400045547,0.00017947263760167124,0.0002044542400742578,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.0010008807750820723,0.0010008807750820723,0.0014054023666975855,0.0014054023666975855,0.0019066503965832825],"xaxis":"x","y":[73.794,78.436,77.408,81.45,81.356,81.164,79.078,78.72,83.02,80.426,83.684,80.476,83.964],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 5.65579 * log10(secs) + 99.0826\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.645126\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"resnetd","marker":{"color":"#ab63fa","symbol":"circle"},"mode":"lines","name":"resnetd","showlegend":false,"x":[0.00011218547400045547,0.00017947263760167124,0.0002044542400742578,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.0010008807750820723,0.0010008807750820723,0.0014054023666975855,0.0014054023666975855,0.0019066503965832825],"xaxis":"x","y":[76.7418223402337,77.89595196059392,78.21605765183251,79.25698485463114,79.25698485463114,79.25698485463114,79.25698485463114,79.25698485463114,82.11734355756117,82.11734355756117,82.95111066374518,82.95111066374518,83.70033533157243],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vgg11_bn.tv_in1k","vgg13.tv_in1k","vgg13_bn.tv_in1k","vgg16.tv_in1k","vgg19.tv_in1k","vgg16_bn.tv_in1k","vgg19_bn.tv_in1k"],"legendgroup":"vgg","marker":{"color":"#FFA15A","size":[50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vgg","orientation":"v","showlegend":true,"x":[0.0003856239395341663,0.000495051955702751,0.000609002271578473,0.00061273383454961,0.0007314379338341244,0.0007335465508641178,0.0008591212907438273],"xaxis":"x","y":[70.382,69.932,71.588,71.592,72.378,73.37,74.216],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 11.8636 * log10(secs) + 110.028\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.823327\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"vgg","marker":{"color":"#FFA15A","symbol":"circle"},"mode":"lines","name":"vgg","showlegend":false,"x":[0.0003856239395341663,0.000495051955702751,0.000609002271578473,0.00061273383454961,0.0007314379338341244,0.0007335465508641178,0.0008591212907438273],"xaxis":"x","y":[69.52744196709077,70.81449063233075,71.88184049620652,71.91331414679166,72.82569499432954,72.84052691476127,73.6546908484885],"yaxis":"y","type":"scatter"},{"customdata":[[288],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnetv2_rw_t.ra2_in1k","efficientnetv2_rw_s.ra2_in1k","efficientnetv2_rw_m.agc_in1k"],"legendgroup":"efficientnetv2","marker":{"color":"#19d3f3","size":[82944,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnetv2","orientation":"v","showlegend":true,"x":[0.00039287790926091805,0.0009177342975661686,0.0025433643623785545],"xaxis":"x","y":[82.35,83.806,84.81],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 3.00733 * log10(secs) + 92.715\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.975096\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"efficientnetv2","marker":{"color":"#19d3f3","symbol":"circle"},"mode":"lines","name":"efficientnetv2","showlegend":false,"x":[0.00039287790926091805,0.0009177342975661686,0.0025433643623785545],"xaxis":"x","y":[82.47283928905576,83.58091959559255,84.91224111535153],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convnext_tiny.in12k_ft_in1k_384","convnext_tiny.in12k_ft_in1k","convnext_tiny.fb_in22k_ft_in1k_384","convnext_tiny.fb_in1k","convnext_tiny.fb_in22k_ft_in1k","convnext_tiny_hnf.a2h_in1k","convnext_small.in12k_ft_in1k_384","convnext_small.fb_in22k_ft_in1k_384","convnext_small.in12k_ft_in1k","convnext_small.fb_in22k_ft_in1k","convnext_small.fb_in1k","convnext_base.clip_laion2b_augreg_ft_in12k_in1k_384","convnext_base.fb_in22k_ft_in1k_384","convnext_base.clip_laiona_augreg_ft_in1k_384","convnext_base.clip_laion2b_augreg_ft_in12k_in1k","convnext_base.fb_in22k_ft_in1k","convnext_base.clip_laion2b_augreg_ft_in1k","convnext_base.fb_in1k","convnext_large.fb_in22k_ft_in1k_384","convnext_large.fb_in22k_ft_in1k","convnext_large.fb_in1k"],"legendgroup":"convnext","marker":{"color":"#FF6692","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convnext","orientation":"v","showlegend":true,"x":[0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00048231356169272765,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001837424665588711,0.001837424665588711,0.001837424665588711],"xaxis":"x","y":[85.122,84.45,84.088,82.698,78.898,82.584,86.182,85.778,85.33,85.262,83.7,87.134,86.796,86.502,86.37,86.274,86.158,84.428,87.472,87.026,84.846],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 6.3023 * log10(secs) + 104.608\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.438464\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"convnext","marker":{"color":"#FF6692","symbol":"circle"},"mode":"lines","name":"convnext","showlegend":false,"x":[0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00048231356169272765,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001837424665588711,0.001837424665588711,0.001837424665588711],"xaxis":"x","y":[83.45100915074968,83.45100915074968,83.45100915074968,83.45100915074968,83.45100915074968,83.70560180292446,84.75974734246851,84.75974734246851,84.75974734246851,84.75974734246851,84.75974734246851,85.74845218086053,85.74845218086053,85.74845218086053,85.74845218086053,85.74845218086053,85.74845218086053,85.74845218086053,87.36648348832054,87.36648348832054,87.36648348832054],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[384],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["swin_tiny_patch4_window7_224.ms_in1k","swin_tiny_patch4_window7_224.ms_in22k_ft_in1k","swin_s3_tiny_224.ms_in1k","swin_small_patch4_window7_224.ms_in22k_ft_in1k","swin_small_patch4_window7_224.ms_in1k","swin_s3_small_224.ms_in1k","swin_base_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window7_224.ms_in1k","swin_s3_base_224.ms_in1k","swin_large_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in1k","swin_large_patch4_window12_384.ms_in22k_ft_in1k"],"legendgroup":"swin","marker":{"color":"#B6E880","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,147456,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"swin","orientation":"v","showlegend":true,"x":[0.0005460184335823177,0.0005460184335823177,0.000599319173418996,0.0008899409969119047,0.0008899409969119047,0.0012179822905374956,0.001254390366281987,0.001254390366281987,0.001502765087761481,0.002185123678000175,0.004700352526439483,0.004700352526439483,0.007950389569088886],"xaxis":"x","y":[81.376,80.968,82.144,83.298,83.208,83.756,85.272,83.606,83.92,86.312,86.438,84.476,87.132],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 4.44822 * log10(secs) + 96.5866\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.772263\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"swin","marker":{"color":"#B6E880","symbol":"circle"},"mode":"lines","name":"swin","showlegend":false,"x":[0.0005460184335823177,0.0005460184335823177,0.000599319173418996,0.0008899409969119047,0.0008899409969119047,0.0012179822905374956,0.001254390366281987,0.001254390366281987,0.001502765087761481,0.002185123678000175,0.004700352526439483,0.004700352526439483,0.007950389569088886],"xaxis":"x","y":[82.07297953517892,82.07297953517892,82.25291375045572,83.01668605778374,83.01668605778374,83.62288793625558,83.6797883488043,83.6797883488043,84.02878824172075,84.7520011952317,86.23172002783447,86.23172002783447,87.24706093713316],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[384],[384],[512]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003einfer_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["beit_base_patch16_224.in22k_ft_in22k_in1k","beit_large_patch16_224.in22k_ft_in22k_in1k","beit_base_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_512.in22k_ft_in22k_in1k"],"legendgroup":"beit","marker":{"color":"#FF97FF","size":[50176,50176,147456,147456,262144],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"beit","orientation":"v","showlegend":true,"x":[0.0010062791820962809,0.0030446034404018876,0.00418007774944614,0.0121580547112462,0.030184123151222455],"xaxis":"x","y":[85.212,87.478,86.8,88.402,88.596],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 2.24263 * log10(secs) + 92.3785\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.860671\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"beit","marker":{"color":"#FF97FF","symbol":"circle"},"mode":"lines","name":"beit","showlegend":false,"x":[0.0010062791820962809,0.0030446034404018876,0.00418007774944614,0.0121580547112462,0.030184123151222455],"xaxis":"x","y":[85.65667590377421,86.73495920794268,87.04366516942372,88.08352661170264,88.9691731071566],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"secs"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"top1"}},"legend":{"title":{"text":"family"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"Inference"},"height":800,"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('be492901-4aba-41da-a2af-37c3df0e8a73');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
<p>From this, we can see that the <em>levit</em> family models are extremely fast for image recognition, and clearly the most accurate amongst the faster models. That’s not surprising, since these models are a hybrid of the best ideas from CNNs and transformers, so get the benefit of each. In fact, we see a similar thing even in the middle category of speeds – the best is the ConvNeXt, which is a pure CNN, but which takes advantage of ideas from the transformers literature.</p>
<p>For the slowest models, <em>beit</em> is the most accurate – although we need to be a bit careful of interpreting this, since it’s trained on a larger dataset (ImageNet-21k, which is also used for <em>vit</em> models).</p>
<p>I’ll add one other plot here, which is of speed vs parameter count. Often, parameter count is used in papers as a proxy for speed. However, as we see, there is a wide variation in speeds at each level of parameter count, so it’s really not a useful proxy.</p>
<p>(Parameter count may be be useful for identifying how much memory a model needs, but even for that it’s not always a great proxy.)</p>
<div id="cell-83" class="cell" data-executioninfo="{&quot;elapsed&quot;:261,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785628769,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="c286b05a-a405-4042-f01a-1d09874b7acb" data-execution_count="15">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>px.scatter(df, width<span class="op">=</span>w, height<span class="op">=</span>h,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'param_count_x'</span>,  y<span class="op">=</span><span class="st">'secs'</span>, log_x<span class="op">=</span><span class="va">True</span>, log_y<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'infer_img_size'</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    hover_name<span class="op">=</span><span class="st">'model_org'</span>, hover_data<span class="op">=</span>[<span class="st">'infer_samples_per_sec'</span>, <span class="st">'family'</span>]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="56770f76-aa28-4f98-9083-e02677649868" class="plotly-graph-div" style="height:800px; width:1000px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("56770f76-aa28-4f98-9083-e02677649868")) {                    Plotly.newPlot(                        "56770f76-aa28-4f98-9083-e02677649868",                        [{"customdata":[[21485.8,"levit"],[17821.98,"regnetx"],[16673.08,"regnety"],[14657.83,"levit"],[14440.03,"regnetx"],[12892.86,"levit"],[12098.59,"vit"],[10826.05,"resnet"],[10826.05,"resnet"],[10826.05,"resnet"],[10826.05,"resnet"],[10826.05,"resnet"],[10826.05,"resnet"],[10826.05,"resnet"],[9982.58,"regnety"],[9895.77,"vit"],[9552.58,"regnety"],[9552.58,"regnety"],[9434.24,"levit"],[8999.14,"efficientnet"],[8913.81,"resnetd"],[8458.52,"regnetx"],[8458.52,"regnetx"],[7937.85,"regnetx"],[7871.11,"regnety"],[7681.79,"efficientnet"],[6262.0,"resnet"],[6262.0,"resnet"],[6262.0,"resnet"],[6262.0,"resnet"],[6262.0,"resnet"],[6262.0,"resnet"],[6224.71,"vit"],[6023.92,"efficientnet"],[5711.75,"efficientnet"],[5710.76,"efficientnet"],[5694.28,"resnet"],[5643.3,"levit"],[5571.88,"resnetd"],[5125.56,"mobilevit"],[5049.08,"repvgg"],[4891.07,"resnetd"],[4316.0,"vit"],[4316.0,"vit"],[4316.0,"vit"],[4101.97,"efficientnet"],[3868.66,"repvgg"],[3854.54,"crossvit"],[3821.39,"efficientnet"],[3802.4,"vit"],[3789.73,"resnet"],[3776.49,"regnetx"],[3776.49,"regnetx"],[3703.17,"resnetv2"],[3640.93,"crossvit"],[3562.28,"crossvit"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3528.73,"resnet"],[3434.61,"efficientnet"],[3414.56,"resnet"],[3408.85,"regnety"],[3408.85,"regnety"],[3369.92,"resnet"],[3201.53,"resnetd"],[3201.53,"resnetd"],[3201.53,"resnetd"],[3201.53,"resnetd"],[3201.53,"resnetd"],[3182.1,"convit"],[3113.3,"efficientnet"],[3098.33,"efficientnet"],[3098.23,"mobilevit"],[2869.21,"resnetaad"],[2844.33,"resnetrs"],[2838.21,"vit"],[2838.21,"vit"],[2715.55,"regnetz"],[2700.75,"vit"],[2619.08,"resnetblur"],[2593.2,"vgg"],[2545.32,"efficientnetv2"],[2415.06,"mobilevit"],[2275.45,"convnext"],[2275.45,"convnext"],[2275.45,"convnext"],[2275.45,"convnext"],[2275.45,"convnext"],[2235.55,"resnetv2"],[2170.93,"resnet"],[2170.93,"resnet"],[2170.93,"resnet"],[2170.93,"resnet"],[2170.93,"resnet"],[2170.93,"resnet"],[2170.93,"resnet"],[2073.34,"convnext"],[2019.99,"vgg"],[1936.11,"repvgg"],[1893.61,"resnetaad"],[1869.52,"resnet"],[1853.06,"efficientnet"],[1844.12,"crossvit"],[1831.44,"swin"],[1831.44,"swin"],[1778.32,"vit"],[1772.58,"regnetz"],[1700.36,"crossvit"],[1677.9,"resnet"],[1668.56,"swin"],[1651.71,"crossvit"],[1642.03,"vgg"],[1632.03,"vgg"],[1614.79,"repvgg"],[1605.58,"regnetx"],[1605.58,"regnetx"],[1586.28,"regnetx"],[1507.31,"resnet"],[1507.31,"resnet"],[1507.31,"resnet"],[1507.31,"resnet"],[1507.31,"resnet"],[1507.31,"resnet"],[1507.31,"resnet"],[1505.49,"efficientnet"],[1505.01,"efficientnet"],[1460.68,"vit"],[1410.61,"convnext"],[1410.61,"convnext"],[1410.61,"convnext"],[1410.61,"convnext"],[1410.61,"convnext"],[1377.87,"vit"],[1377.87,"vit"],[1368.52,"convit"],[1367.75,"regnety"],[1367.75,"regnety"],[1367.75,"regnety"],[1367.17,"vgg"],[1363.24,"vgg"],[1259.62,"regnetx"],[1259.62,"regnetx"],[1243.81,"repvgg"],[1205.55,"crossvit"],[1172.17,"crossvit"],[1166.56,"regnetx"],[1163.98,"vgg"],[1143.01,"regnetz"],[1123.67,"swin"],[1123.67,"swin"],[1108.89,"vit"],[1095.82,"resnetrs"],[1089.64,"efficientnetv2"],[1073.46,"vit"],[1073.46,"vit"],[1073.46,"vit"],[1073.46,"vit"],[1073.46,"vit"],[1039.59,"regnetz"],[1009.91,"regnetz"],[1001.81,"repvgg"],[999.12,"resnetd"],[999.12,"resnetd"],[993.76,"beit"],[982.94,"convnext"],[982.94,"convnext"],[982.94,"convnext"],[982.94,"convnext"],[982.94,"convnext"],[982.94,"convnext"],[982.94,"convnext"],[974.19,"efficientnet"],[849.33,"regnety"],[849.33,"regnety"],[849.16,"regnetv"],[834.99,"resnetv2d"],[821.03,"swin"],[812.87,"repvgg"],[797.2,"swin"],[797.2,"swin"],[777.95,"regnetx"],[754.35,"regnety"],[754.35,"regnety"],[747.2,"crossvit"],[721.71,"vit"],[711.54,"resnetd"],[711.54,"resnetd"],[687.54,"convit"],[683.58,"vit"],[683.58,"vit"],[665.44,"swin"],[644.06,"repvgg"],[628.07,"resnetrs"],[623.38,"regnetx"],[623.38,"regnetx"],[607.41,"regnetz"],[598.38,"regnetz"],[582.99,"vit"],[544.24,"convnext"],[544.24,"convnext"],[544.24,"convnext"],[536.38,"regnety"],[536.38,"regnety"],[524.48,"resnetd"],[479.45,"vit"],[471.86,"regnety"],[471.86,"regnety"],[468.27,"regnetv"],[467.72,"efficientnet"],[457.64,"swin"],[456.26,"resnetrs"],[415.34,"regnety"],[415.34,"regnety"],[415.34,"regnety"],[415.34,"regnety"],[415.34,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[414.45,"regnety"],[393.18,"efficientnetv2"],[387.65,"regnetz"],[354.58,"vit"],[354.15,"crossvit"],[328.45,"beit"],[287.51,"resnetrs"],[277.57,"vit"],[277.57,"vit"],[277.57,"vit"],[262.23,"regnetx"],[262.23,"regnetx"],[259.11,"crossvit"],[239.23,"beit"],[236.31,"vit"],[212.75,"swin"],[212.75,"swin"],[188.78,"resnetrs"],[182.98,"vit"],[182.98,"vit"],[171.75,"vit"],[134.22,"resnetrs"],[125.78,"swin"],[94.39,"vit"],[82.25,"beit"],[33.13,"beit"]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003eparam_count_x=%{x}\u003cbr\u003esecs=%{y}\u003cbr\u003einfer_samples_per_sec=%{customdata[0]}\u003cbr\u003efamily=%{customdata[1]}\u003cbr\u003einfer_img_size=%{marker.color}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["levit_128s.fb_dist_in1k","regnetx_002.pycls_in1k","regnety_002.pycls_in1k","levit_128.fb_dist_in1k","regnetx_004.pycls_in1k","levit_192.fb_dist_in1k","vit_small_patch32_224.augreg_in21k_ft_in1k","resnet18.fb_swsl_ig1b_ft_in1k","resnet18.a1_in1k","resnet18.fb_ssl_yfcc100m_ft_in1k","resnet18.a2_in1k","resnet18.gluon_in1k","resnet18.tv_in1k","resnet18.a3_in1k","regnety_006.pycls_in1k","vit_tiny_r_s16_p8_224.augreg_in21k_ft_in1k","regnety_004.tv2_in1k","regnety_004.pycls_in1k","levit_256.fb_dist_in1k","efficientnet_lite0.ra_in1k","resnet18d.ra2_in1k","regnetx_008.tv2_in1k","regnetx_008.pycls_in1k","regnetx_006.pycls_in1k","regnety_008.pycls_in1k","efficientnet_b0.ra_in1k","resnet34.a1_in1k","resnet34.a2_in1k","resnet34.bt_in1k","resnet34.gluon_in1k","resnet34.tv_in1k","resnet34.a3_in1k","vit_tiny_patch16_224.augreg_in21k_ft_in1k","efficientnet_b1_pruned.in1k","efficientnet_es.ra_in1k","efficientnet_es_pruned.in1k","resnet26.bt_in1k","levit_384.fb_dist_in1k","resnet34d.ra2_in1k","mobilevit_xxs.cvnets_in1k","repvgg_b0.rvgg_in1k","resnet26d.bt_in1k","vit_base_patch32_224.augreg_in21k_ft_in1k","vit_base_patch32_224.augreg_in1k","vit_base_patch32_224.sam_in1k","efficientnet_b1.ft_in1k","repvgg_a2.rvgg_in1k","crossvit_tiny_240.in1k","efficientnet_b2_pruned.in1k","vit_small_patch32_384.augreg_in21k_ft_in1k","resnet26t.ra2_in1k","regnetx_016.tv2_in1k","regnetx_016.pycls_in1k","resnetv2_50.a1h_in1k","crossvit_9_240.in1k","crossvit_9_dagger_240.in1k","resnet50.a1_in1k","resnet50.fb_swsl_ig1b_ft_in1k","resnet50.d_in1k","resnet50.c1_in1k","resnet50.c2_in1k","resnet50.tv2_in1k","resnet50.a2_in1k","resnet50.b1k_in1k","resnet50.a1h_in1k","resnet50.b2k_in1k","resnet50.ram_in1k","resnet50.ra_in1k","resnet50.bt_in1k","resnet50.fb_ssl_yfcc100m_ft_in1k","resnet50.am_in1k","resnet50.a3_in1k","resnet50.gluon_in1k","resnet50.tv_in1k","efficientnet_em.ra2_in1k","resnet32ts.ra2_in1k","regnety_016.tv2_in1k","regnety_016.pycls_in1k","resnet33ts.ra2_in1k","resnet50d.a1_in1k","resnet50d.ra2_in1k","resnet50d.a2_in1k","resnet50d.gluon_in1k","resnet50d.a3_in1k","convit_tiny.fb_in1k","efficientnet_b2.ra_in1k","efficientnet_b3_pruned.in1k","mobilevit_xs.cvnets_in1k","resnetaa50d.sw_in12k_ft_in1k","resnetrs50.tf_in1k","vit_small_patch16_224.augreg_in21k_ft_in1k","vit_small_patch16_224.augreg_in1k","regnetz_b16.ra3_in1k","vit_tiny_r_s16_p8_384.augreg_in21k_ft_in1k","resnetblur50.bt_in1k","vgg11_bn.tv_in1k","efficientnetv2_rw_t.ra2_in1k","mobilevit_s.cvnets_in1k","convnext_tiny.in12k_ft_in1k_384","convnext_tiny.in12k_ft_in1k","convnext_tiny.fb_in22k_ft_in1k_384","convnext_tiny.fb_in1k","convnext_tiny.fb_in22k_ft_in1k","resnetv2_101.a1h_in1k","resnet101.a1h_in1k","resnet101.a1_in1k","resnet101.a2_in1k","resnet101.tv2_in1k","resnet101.a3_in1k","resnet101.gluon_in1k","resnet101.tv_in1k","convnext_tiny_hnf.a2h_in1k","vgg13.tv_in1k","repvgg_b1.rvgg_in1k","resnetaa101d.sw_in12k_ft_in1k","resnet51q.ra2_in1k","efficientnet_b3.ra2_in1k","crossvit_small_240.in1k","swin_tiny_patch4_window7_224.ms_in1k","swin_tiny_patch4_window7_224.ms_in22k_ft_in1k","vit_small_r26_s32_224.augreg_in21k_ft_in1k","regnetz_c16.ra3_in1k","crossvit_15_240.in1k","resnet61q.ra2_in1k","swin_s3_tiny_224.ms_in1k","crossvit_15_dagger_240.in1k","vgg13_bn.tv_in1k","vgg16.tv_in1k","repvgg_b1g4.rvgg_in1k","regnetx_032.tv2_in1k","regnetx_032.pycls_in1k","regnetx_040.pycls_in1k","resnet152.a1h_in1k","resnet152.a1_in1k","resnet152.a2_in1k","resnet152.tv2_in1k","resnet152.a3_in1k","resnet152.gluon_in1k","resnet152.tv_in1k","efficientnet_el.ra_in1k","efficientnet_el_pruned.in1k","vit_tiny_patch16_384.augreg_in21k_ft_in1k","convnext_small.in12k_ft_in1k_384","convnext_small.fb_in22k_ft_in1k_384","convnext_small.in12k_ft_in1k","convnext_small.fb_in22k_ft_in1k","convnext_small.fb_in1k","vit_base_patch32_384.augreg_in21k_ft_in1k","vit_base_patch32_384.augreg_in1k","convit_small.fb_in1k","regnety_032.ra_in1k","regnety_032.tv2_in1k","regnety_032.pycls_in1k","vgg19.tv_in1k","vgg16_bn.tv_in1k","regnetx_080.tv2_in1k","regnetx_080.pycls_in1k","repvgg_b2.rvgg_in1k","crossvit_18_240.in1k","crossvit_18_dagger_240.in1k","regnetx_064.pycls_in1k","vgg19_bn.tv_in1k","regnetz_d8.ra3_in1k","swin_small_patch4_window7_224.ms_in22k_ft_in1k","swin_small_patch4_window7_224.ms_in1k","vit_base_patch16_224_miil.in21k_ft_in1k","resnetrs101.tf_in1k","efficientnetv2_rw_s.ra2_in1k","vit_base_patch16_224.augreg2_in21k_ft_in1k","vit_base_patch16_224.augreg_in21k_ft_in1k","vit_base_patch16_224.orig_in21k_ft_in1k","vit_base_patch16_224.sam_in1k","vit_base_patch16_224.augreg_in1k","regnetz_040.ra3_in1k","regnetz_d32.ra3_in1k","repvgg_b3.rvgg_in1k","resnet101d.ra2_in1k","resnet101d.gluon_in1k","beit_base_patch16_224.in22k_ft_in22k_in1k","convnext_base.clip_laion2b_augreg_ft_in12k_in1k_384","convnext_base.fb_in22k_ft_in1k_384","convnext_base.clip_laiona_augreg_ft_in1k_384","convnext_base.clip_laion2b_augreg_ft_in12k_in1k","convnext_base.fb_in22k_ft_in1k","convnext_base.clip_laion2b_augreg_ft_in1k","convnext_base.fb_in1k","efficientnet_b4.ra2_in1k","regnety_040.ra3_in1k","regnety_040.pycls_in1k","regnetv_040.ra3_in1k","resnetv2_50d_evos.ah_in1k","swin_s3_small_224.ms_in1k","repvgg_b2g4.rvgg_in1k","swin_base_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window7_224.ms_in1k","regnetx_120.pycls_in1k","regnety_120.sw_in12k_ft_in1k","regnety_120.pycls_in1k","crossvit_base_240.in1k","vit_large_r50_s32_224.augreg_in21k_ft_in1k","resnet152d.ra2_in1k","resnet152d.gluon_in1k","convit_base.fb_in1k","vit_small_patch16_384.augreg_in21k_ft_in1k","vit_small_patch16_384.augreg_in1k","swin_s3_base_224.ms_in1k","repvgg_b3g4.rvgg_in1k","resnetrs152.tf_in1k","regnetx_160.tv2_in1k","regnetx_160.pycls_in1k","regnetz_e8.ra3_in1k","regnetz_c16_evos.ch_in1k","vit_small_r26_s32_384.augreg_in21k_ft_in1k","convnext_large.fb_in22k_ft_in1k_384","convnext_large.fb_in22k_ft_in1k","convnext_large.fb_in1k","regnety_080.ra3_in1k","regnety_080.pycls_in1k","resnet200d.ra2_in1k","vit_large_patch32_384.orig_in21k_ft_in1k","regnety_064.ra3_in1k","regnety_064.pycls_in1k","regnetv_064.ra3_in1k","efficientnet_b5.sw_in12k_ft_in1k","swin_large_patch4_window7_224.ms_in22k_ft_in1k","resnetrs200.tf_in1k","regnety_320.swag_ft_in1k","regnety_320.swag_lc_in1k","regnety_320.seer_ft_in1k","regnety_320.tv2_in1k","regnety_320.pycls_in1k","regnety_160.swag_ft_in1k","regnety_160.lion_in12k_ft_in1k","regnety_160.sw_in12k_ft_in1k","regnety_160.swag_lc_in1k","regnety_160.deit_in1k","regnety_160.tv2_in1k","regnety_160.pycls_in1k","efficientnetv2_rw_m.agc_in1k","regnetz_d8_evos.ch_in1k","vit_large_patch16_224.augreg_in21k_ft_in1k","crossvit_15_dagger_408.in1k","beit_large_patch16_224.in22k_ft_in22k_in1k","resnetrs270.tf_in1k","vit_base_patch16_384.augreg_in21k_ft_in1k","vit_base_patch16_384.orig_in21k_ft_in1k","vit_base_patch16_384.augreg_in1k","regnetx_320.tv2_in1k","regnetx_320.pycls_in1k","crossvit_18_dagger_408.in1k","beit_base_patch16_384.in22k_ft_in22k_in1k","vit_large_r50_s32_384.augreg_in21k_ft_in1k","swin_base_patch4_window12_384.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in1k","resnetrs350.tf_in1k","vit_base_patch8_224.augreg2_in21k_ft_in1k","vit_base_patch8_224.augreg_in21k_ft_in1k","vit_base_r50_s16_384.orig_in21k_ft_in1k","resnetrs420.tf_in1k","swin_large_patch4_window12_384.ms_in22k_ft_in1k","vit_large_patch16_384.augreg_in21k_ft_in1k","beit_large_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_512.in22k_ft_in22k_in1k"],"legendgroup":"","marker":{"color":[224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,240,224,224,224,224,224,256,224,224,224,224,224,256,224,240,260,384,256,224,224,224,240,240,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,240,256,224,224,256,224,224,224,224,224,224,288,300,256,224,224,224,224,288,384,224,224,288,256,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,224,288,320,240,224,224,224,320,240,288,224,240,224,224,224,224,224,224,224,224,224,224,224,224,224,300,300,384,224,224,224,224,224,384,384,224,288,288,288,224,224,224,224,224,240,240,224,224,320,224,224,224,288,384,224,224,224,224,224,320,320,224,320,320,224,224,224,224,224,224,224,224,384,288,288,288,288,224,224,224,224,224,224,224,240,224,320,320,224,384,384,224,224,320,224,224,320,320,384,224,224,224,288,288,320,384,288,288,288,456,224,320,224,224,224,224,224,288,288,288,288,288,288,288,416,320,224,408,224,352,384,384,384,224,224,408,384,384,384,384,384,224,224,384,416,384,384,384,512],"coloraxis":"coloraxis","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[7.78,2.68,3.16,9.21,5.16,10.95,22.88,11.69,11.69,11.69,11.69,11.69,11.69,11.69,6.06,6.34,4.34,4.34,18.89,4.65,11.71,7.26,7.26,6.2,6.26,5.29,21.8,21.8,21.8,21.8,21.8,21.8,5.72,6.33,5.44,5.44,16.0,39.13,21.82,1.27,15.82,16.01,88.22,88.22,88.22,7.79,28.21,7.01,8.31,22.92,16.01,9.19,9.19,25.55,8.55,8.78,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,25.56,6.9,17.96,11.2,11.2,19.68,25.58,25.58,25.58,25.58,25.58,5.71,9.11,9.86,2.32,25.58,35.69,22.05,22.05,9.72,6.36,25.56,132.87,13.65,5.58,28.59,28.59,28.59,28.59,28.59,44.54,44.55,44.55,44.55,44.55,44.55,44.55,44.55,28.59,133.05,57.42,44.57,35.7,12.23,26.86,28.29,28.29,36.43,13.46,27.53,36.85,28.33,28.21,133.05,138.36,39.97,15.3,15.3,22.12,60.19,60.19,60.19,60.19,60.19,60.19,60.19,10.59,10.59,5.79,50.22,50.22,50.22,50.22,50.22,88.3,88.3,27.78,19.44,19.44,19.44,143.67,138.37,39.57,39.57,89.02,43.27,44.27,26.21,143.68,23.37,49.61,49.61,86.54,63.62,23.94,86.57,86.57,86.57,86.57,86.57,27.12,27.58,123.09,44.57,44.57,86.53,88.59,88.59,88.59,88.59,88.59,88.59,88.59,19.34,20.65,20.65,20.64,25.59,49.74,61.76,87.77,87.77,46.11,51.82,51.82,105.03,328.99,60.21,60.21,86.54,22.2,22.2,71.13,83.83,86.62,54.28,54.28,57.7,13.49,36.47,197.77,197.77,197.77,39.18,39.18,64.69,306.63,30.58,30.58,30.58,30.39,196.53,93.21,145.05,145.05,145.05,145.05,145.05,83.59,83.59,83.59,83.59,83.59,83.59,83.59,53.24,23.46,304.33,28.5,304.43,129.86,86.86,86.86,86.86,107.81,107.81,44.61,86.74,329.09,87.9,87.9,163.96,86.58,86.58,98.95,191.89,196.74,304.72,305.0,305.67],"xaxis":"x","y":[4.654236751715086e-05,5.611048828469115e-05,5.9976920880845045e-05,6.822292249261998e-05,6.925193368711838e-05,7.756230968148262e-05,8.26542597112556e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,9.236979323021786e-05,0.00010017450398594352,0.00010105327831992861,0.00010468376082691796,0.00010468376082691796,0.00010599687945186893,0.00011112172940969915,0.00011218547400045547,0.00011822399190402103,0.00011822399190402103,0.0001259786970023369,0.00012704688411164372,0.0001301779923689661,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.00015969338869370808,0.0001606500543800434,0.00016600486062231902,0.00017507769072525934,0.00017510804166170527,0.00017561482751111642,0.00017720128293728847,0.00017947263760167124,0.00019510063290645313,0.00019805588344807372,0.0002044542400742578,0.00023169601482854495,0.00023169601482854495,0.00023169601482854495,0.00024378530315921374,0.00025848743492578826,0.00025943432938820195,0.0002616848842960284,0.0002629917946560067,0.0002638710409448694,0.00026479614668647344,0.00026479614668647344,0.00027003891260730673,0.0002746551018558445,0.0002807190900209978,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.00028338807446305045,0.0002911538719097656,0.00029286350217890445,0.00029335406368716726,0.00029335406368716726,0.00029674294938752255,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.00031235065734195835,0.0003142578800163414,0.00032120258246876303,0.00032275451614256713,0.00032276493352656195,0.00034852799202567954,0.000351576645466595,0.0003523347461956656,0.0003523347461956656,0.00036824952587873543,0.0003702675182819587,0.00038181346121538863,0.0003856239395341663,0.00039287790926091805,0.0004140683875348853,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.00043947351073414054,0.0004473172150030194,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00046063207933926936,0.00048231356169272765,0.000495051955702751,0.0005164995790528431,0.0005280918457338101,0.000534896657965681,0.000539647933688062,0.0005422640609070993,0.0005460184335823177,0.0005460184335823177,0.0005623284898106078,0.0005641494319015222,0.0005881107530170082,0.0005959830740806961,0.000599319173418996,0.0006054331571522846,0.000609002271578473,0.00061273383454961,0.0006192755714365336,0.0006228278877415016,0.0006228278877415016,0.0006304057291272663,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006634335339114052,0.0006642355645005945,0.0006644474123095528,0.0006846126461648,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007089131652263915,0.0007257578726585237,0.0007257578726585237,0.0007307163943530237,0.0007311277645768598,0.0007311277645768598,0.0007311277645768598,0.0007314379338341244,0.0007335465508641178,0.0007938902208602596,0.0007938902208602596,0.0008039813154742284,0.0008294969101240098,0.0008531185749507324,0.0008572212316554657,0.0008591212907438273,0.0008748829844008363,0.0008899409969119047,0.0008899409969119047,0.0009018027036045053,0.0009125586318920991,0.0009177342975661686,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.0009315670821455853,0.000961917679085024,0.0009901872444079175,0.0009981932701809725,0.0010008807750820723,0.0010008807750820723,0.0010062791820962809,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.001017356094980365,0.0010264938051098862,0.0011773986554107355,0.0011773986554107355,0.0011776343680813981,0.0011976191331632715,0.0012179822905374956,0.0012302090125112257,0.001254390366281987,0.001254390366281987,0.0012854296548621376,0.0013256445946841651,0.0013256445946841651,0.0013383297644539614,0.0013855980934170233,0.0014054023666975855,0.0014054023666975855,0.0014544608313698112,0.0014628865677755345,0.0014628865677755345,0.001502765087761481,0.0015526503741887404,0.0015921792156925183,0.001604157977477622,0.001604157977477622,0.0016463344363774057,0.00167117884956048,0.0017152952880838436,0.001837424665588711,0.001837424665588711,0.001837424665588711,0.0018643499011894553,0.0018643499011894553,0.0019066503965832825,0.002085723224528105,0.0021192726656211586,0.0021192726656211586,0.0021355201059217975,0.0021380313007782433,0.002185123678000175,0.0021917327839389824,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.002407666008571291,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0024128362890577875,0.0025433643623785545,0.002579646588417387,0.0028202380280895707,0.002823662289990117,0.0030446034404018876,0.0034781398907864076,0.0036026948157221604,0.0036026948157221604,0.0036026948157221604,0.0038134462113411888,0.0038134462113411888,0.0038593647485623862,0.00418007774944614,0.004231729507849859,0.004700352526439483,0.004700352526439483,0.005297171310520182,0.005465078150617554,0.005465078150617554,0.005822416302765648,0.007450454477723141,0.007950389569088886,0.010594342621040365,0.0121580547112462,0.030184123151222455],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"param_count_x"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"secs"},"type":"log"},"coloraxis":{"colorbar":{"title":{"text":"infer_img_size"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":800,"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('56770f76-aa28-4f98-9083-e02677649868');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
</section>
<section id="training-results" class="level2">
<h2 class="anchored" data-anchor-id="training-results">Training results</h2>
<p>We’ll now replicate the above analysis for training performance. First we grab the data:</p>
<div id="cell-86" class="cell" data-executioninfo="{&quot;elapsed&quot;:366,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785631365,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>tdf <span class="op">=</span> get_data(<span class="st">'train'</span>, <span class="st">'train_samples_per_sec'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can repeat the same <em>family</em> plot we did above:</p>
<div id="cell-88" class="cell" data-executioninfo="{&quot;elapsed&quot;:375,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785632945,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="ddb4486a-d9a3-4bce-b23c-86f5d9bfd681" data-execution_count="17">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>show_all(tdf, <span class="st">'Training'</span>, <span class="st">'train_img_size'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="a902debb-aa30-454c-90d5-2f2048b47fd4" class="plotly-graph-div" style="height:800px; width:1000px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a902debb-aa30-454c-90d5-2f2048b47fd4")) {                    Plotly.newPlot(                        "a902debb-aa30-454c-90d5-2f2048b47fd4",                        [{"customdata":[[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["levit_128s.fb_dist_in1k","levit_128.fb_dist_in1k","levit_192.fb_dist_in1k","levit_256.fb_dist_in1k","levit_384.fb_dist_in1k"],"legendgroup":"levit","marker":{"color":"#636efa","size":[50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"levit","orientation":"v","showlegend":true,"x":[0.00015865108501477042,0.00022550151537018326,0.00026151037934695625,0.000342053415061296,0.0005556697765651828],"xaxis":"x","y":[76.526,78.49,79.838,81.524,82.596],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[384],[384],[224],[224],[224],[384],[384],[384],[224],[224],[224],[224],[224],[224],[384],[384],[224],[384],[384],[224],[384],[384],[384],[384],[224],[224],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vit_small_patch32_224.augreg_in21k_ft_in1k","vit_tiny_r_s16_p8_224.augreg_in21k_ft_in1k","vit_tiny_patch16_224.augreg_in21k_ft_in1k","vit_base_patch32_224.augreg_in21k_ft_in1k","vit_base_patch32_224.augreg_in1k","vit_base_patch32_224.sam_in1k","vit_small_patch32_384.augreg_in21k_ft_in1k","vit_tiny_r_s16_p8_384.augreg_in21k_ft_in1k","vit_small_patch16_224.augreg_in21k_ft_in1k","vit_small_patch16_224.augreg_in1k","vit_small_r26_s32_224.augreg_in21k_ft_in1k","vit_base_patch32_384.augreg_in21k_ft_in1k","vit_base_patch32_384.augreg_in1k","vit_tiny_patch16_384.augreg_in21k_ft_in1k","vit_base_patch16_224_miil.in21k_ft_in1k","vit_base_patch16_224.augreg2_in21k_ft_in1k","vit_base_patch16_224.augreg_in21k_ft_in1k","vit_base_patch16_224.orig_in21k_ft_in1k","vit_base_patch16_224.sam_in1k","vit_base_patch16_224.augreg_in1k","vit_small_patch16_384.augreg_in21k_ft_in1k","vit_small_patch16_384.augreg_in1k","vit_large_r50_s32_224.augreg_in21k_ft_in1k","vit_small_r26_s32_384.augreg_in21k_ft_in1k","vit_large_patch32_384.orig_in21k_ft_in1k","vit_large_patch16_224.augreg_in21k_ft_in1k","vit_base_patch16_384.augreg_in21k_ft_in1k","vit_base_patch16_384.orig_in21k_ft_in1k","vit_base_patch16_384.augreg_in1k","vit_large_r50_s32_384.augreg_in21k_ft_in1k","vit_base_patch8_224.augreg2_in21k_ft_in1k","vit_base_patch8_224.augreg_in21k_ft_in1k","vit_base_r50_s16_384.orig_in21k_ft_in1k","vit_large_patch16_384.augreg_in21k_ft_in1k"],"legendgroup":"vit","marker":{"color":"#EF553B","size":[50176,50176,50176,50176,50176,50176,147456,147456,50176,50176,50176,147456,147456,147456,50176,50176,50176,50176,50176,50176,147456,147456,50176,147456,147456,50176,147456,147456,147456,147456,50176,50176,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vit","orientation":"v","showlegend":true,"x":[0.00023073053903268528,0.00025923592802573695,0.0004485431319075642,0.0006199781767681778,0.0006199781767681778,0.0006199781767681778,0.0007068736392682444,0.0008379069085424609,0.0009731128908264647,0.0009731128908264647,0.0014655450361989624,0.0019330395113276114,0.0019330395113276114,0.001984363217843394,0.002551866690484089,0.002595851828777613,0.002595851828777613,0.002595851828777613,0.002595851828777613,0.002595851828777613,0.004245923913043478,0.004245923913043478,0.004369101712687872,0.004516507836141096,0.0061793239819563734,0.008666262241095415,0.010450412791305257,0.010450412791305257,0.010450412791305257,0.013199577613516367,0.01588310038119441,0.01588310038119441,0.016992353440951572,0.03466204506065858],"xaxis":"x","y":[75.994,71.798,75.462,80.716,74.894,73.694,80.486,75.96,81.386,78.848,81.864,83.352,78.756,78.424,84.266,85.094,84.532,81.79,80.238,79.154,83.804,81.116,84.418,84.048,81.51,85.836,85.994,84.2,81.102,86.182,86.218,85.798,84.976,87.084],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18.fb_swsl_ig1b_ft_in1k","resnet18.a1_in1k","resnet18.fb_ssl_yfcc100m_ft_in1k","resnet18.a2_in1k","resnet18.gluon_in1k","resnet18.tv_in1k","resnet18.a3_in1k","resnet34.a1_in1k","resnet34.a2_in1k","resnet34.bt_in1k","resnet34.gluon_in1k","resnet34.tv_in1k","resnet34.a3_in1k","resnet26.bt_in1k","resnet26t.ra2_in1k","resnet50.a1_in1k","resnet50.fb_swsl_ig1b_ft_in1k","resnet50.d_in1k","resnet50.c1_in1k","resnet50.c2_in1k","resnet50.tv2_in1k","resnet50.a2_in1k","resnet50.b1k_in1k","resnet50.a1h_in1k","resnet50.b2k_in1k","resnet50.ram_in1k","resnet50.ra_in1k","resnet50.bt_in1k","resnet50.fb_ssl_yfcc100m_ft_in1k","resnet50.am_in1k","resnet50.a3_in1k","resnet50.gluon_in1k","resnet50.tv_in1k","resnet32ts.ra2_in1k","resnet33ts.ra2_in1k","resnet101.a1h_in1k","resnet101.a1_in1k","resnet101.a2_in1k","resnet101.tv2_in1k","resnet101.a3_in1k","resnet101.gluon_in1k","resnet101.tv_in1k","resnet152.a1h_in1k","resnet152.a1_in1k","resnet152.a2_in1k","resnet152.tv2_in1k","resnet152.a3_in1k","resnet152.gluon_in1k","resnet152.tv_in1k","resnet51q.ra2_in1k","resnet61q.ra2_in1k"],"legendgroup":"resnet","marker":{"color":"#00cc96","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnet","orientation":"v","showlegend":true,"x":[0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0005087349795997273,0.000814431730260211,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0009786938352075321,0.0009906973518659784,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0035980282805022847,0.004809773459670049],"xaxis":"x","y":[73.288,73.158,72.598,72.372,70.834,69.76,68.252,77.918,77.158,76.48,74.58,73.306,72.97,76.366,78.328,81.214,81.172,80.972,80.912,80.87,80.848,80.772,80.706,80.678,80.454,79.976,79.836,79.64,79.23,79.002,78.048,77.582,76.128,79.388,79.726,82.778,82.322,82.236,81.888,79.814,79.31,77.38,83.45,82.732,82.608,82.286,80.546,79.696,78.322,82.36,82.524],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18d.ra2_in1k","resnet34d.ra2_in1k","resnet26d.bt_in1k","resnet50d.a1_in1k","resnet50d.ra2_in1k","resnet50d.a2_in1k","resnet50d.gluon_in1k","resnet50d.a3_in1k","resnet101d.ra2_in1k","resnet101d.gluon_in1k","resnet152d.ra2_in1k","resnet152d.gluon_in1k","resnet200d.ra2_in1k"],"legendgroup":"resnetd","marker":{"color":"#ab63fa","size":[50176,50176,50176,50176,50176,50176,50176,50176,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetd","orientation":"v","showlegend":true,"x":[0.0003533543932551713,0.0005558550996926121,0.0006213611537433903,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.003054274457102715,0.003054274457102715,0.0046277014207043365,0.0046277014207043365,0.006017209218364523],"xaxis":"x","y":[73.794,78.436,77.408,81.45,81.356,81.164,79.078,78.72,83.02,80.426,83.684,80.476,83.964],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetx_002.pycls_in1k","regnetx_004.pycls_in1k","regnetx_006.pycls_in1k","regnetx_008.tv2_in1k","regnetx_008.pycls_in1k","regnetx_016.tv2_in1k","regnetx_016.pycls_in1k","regnetx_032.tv2_in1k","regnetx_032.pycls_in1k","regnetx_040.pycls_in1k","regnetx_080.tv2_in1k","regnetx_080.pycls_in1k","regnetx_064.pycls_in1k","regnetx_120.pycls_in1k","regnetx_160.tv2_in1k","regnetx_160.pycls_in1k","regnetx_320.tv2_in1k","regnetx_320.pycls_in1k"],"legendgroup":"regnetx","marker":{"color":"#FFA15A","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetx","orientation":"v","showlegend":true,"x":[0.0004215904922912179,0.0008689456213830139,0.0012649261283141065,0.001689760054072322,0.001689760054072322,0.002637061258933045,0.002637061258933045,0.005628095452498874,0.005628095452498874,0.006177796997590659,0.0066657778962804955,0.0066657778962804955,0.008056070248932571,0.012896569512509672,0.015382248884786955,0.015382248884786955,0.021663778162911613,0.021663778162911613],"xaxis":"x","y":[68.752,72.402,73.868,77.306,75.028,79.436,76.924,80.926,78.168,78.492,81.54,79.198,79.066,79.588,82.566,79.866,82.81,80.246],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[288],[288],[288],[288],[288],[224],[224],[288],[288],[224],[224],[224],[224],[224],[288],[288],[288],[288],[288],[288],[288],[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnety\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnety_002.pycls_in1k","regnety_004.tv2_in1k","regnety_004.pycls_in1k","regnety_006.pycls_in1k","regnety_008.pycls_in1k","regnety_016.tv2_in1k","regnety_016.pycls_in1k","regnety_032.ra_in1k","regnety_032.tv2_in1k","regnety_032.pycls_in1k","regnety_040.ra3_in1k","regnety_040.pycls_in1k","regnety_120.sw_in12k_ft_in1k","regnety_120.pycls_in1k","regnety_064.ra3_in1k","regnety_064.pycls_in1k","regnety_320.swag_ft_in1k","regnety_320.swag_lc_in1k","regnety_320.seer_ft_in1k","regnety_320.tv2_in1k","regnety_320.pycls_in1k","regnety_080.ra3_in1k","regnety_080.pycls_in1k","regnety_160.swag_ft_in1k","regnety_160.lion_in12k_ft_in1k","regnety_160.sw_in12k_ft_in1k","regnety_160.swag_lc_in1k","regnety_160.deit_in1k","regnety_160.tv2_in1k","regnety_160.pycls_in1k"],"legendgroup":"regnety","marker":{"color":"#19d3f3","size":[50176,50176,50176,50176,50176,50176,50176,82944,82944,82944,82944,82944,50176,50176,82944,82944,50176,50176,50176,50176,50176,82944,82944,82944,82944,82944,82944,82944,82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnety","orientation":"v","showlegend":true,"x":[0.00044342751733801594,0.0009734728644439036,0.0009734728644439036,0.0012694221590332081,0.0015109848599317035,0.002829975096219153,0.002829975096219153,0.005617661929105107,0.005617661929105107,0.005617661929105107,0.008316008316008316,0.008316008316008316,0.013273161667109104,0.013273161667109104,0.013757050488375293,0.013757050488375293,0.014817009927396653,0.014817009927396653,0.014817009927396653,0.014817009927396653,0.014817009927396653,0.015278838808250572,0.015278838808250572,0.02077274615704196,0.02077274615704196,0.02077274615704196,0.02077274615704196,0.02077274615704196,0.02077274615704196,0.02077274615704196],"xaxis":"x","y":[70.28,75.594,74.026,75.268,76.302,80.666,77.868,82.726,81.756,78.876,83.044,79.22,85.4,80.38,83.72,79.716,86.834,84.548,83.328,83.162,80.81,83.926,79.868,86.02,85.988,85.986,83.782,83.69,82.646,80.298],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[240],[240],[256],[260],[288],[300],[300],[300],[320],[384],[456]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnet_lite0.ra_in1k","efficientnet_b0.ra_in1k","efficientnet_es.ra_in1k","efficientnet_es_pruned.in1k","efficientnet_b1_pruned.in1k","efficientnet_em.ra2_in1k","efficientnet_b1.ft_in1k","efficientnet_b2_pruned.in1k","efficientnet_b2.ra_in1k","efficientnet_b3_pruned.in1k","efficientnet_el.ra_in1k","efficientnet_el_pruned.in1k","efficientnet_b3.ra2_in1k","efficientnet_b4.ra2_in1k","efficientnet_b5.sw_in12k_ft_in1k"],"legendgroup":"efficientnet","marker":{"color":"#FF6692","size":[50176,50176,50176,50176,57600,57600,65536,67600,82944,90000,90000,90000,102400,147456,207936],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnet","orientation":"v","showlegend":true,"x":[0.0004526361529548088,0.0005553796853218703,0.0006177300890149058,0.0006187850773790739,0.0007223763291724458,0.0010220141855568955,0.001047219109654313,0.0012109909538975743,0.0013808149569876141,0.0019251872244575787,0.0021957753282684117,0.002201091741503786,0.0028314174075542214,0.004141301196836046,0.010279605263157895],"xaxis":"x","y":[75.482,77.694,78.058,75.006,78.24,79.244,78.8,79.92,80.61,80.852,81.312,80.298,82.246,83.414,85.896],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=repvgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["repvgg_b0.rvgg_in1k","repvgg_a2.rvgg_in1k","repvgg_b1.rvgg_in1k","repvgg_b2.rvgg_in1k","repvgg_b3.rvgg_in1k","repvgg_b1g4.rvgg_in1k","repvgg_b2g4.rvgg_in1k","repvgg_b3g4.rvgg_in1k"],"legendgroup":"repvgg","marker":{"color":"#B6E880","size":[50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"repvgg","orientation":"v","showlegend":true,"x":[0.0006304573968414084,0.0008755494072530513,0.0015941081761808359,0.0026313712075362473,0.003168969451134491,0.0056050669805504175,0.00977230528681716,0.011799410029498525],"xaxis":"x","y":[75.144,76.458,78.368,78.792,80.506,77.588,79.382,80.216],"yaxis":"y","type":"scatter"},{"customdata":[[256],[256],[256]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=mobilevit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["mobilevit_xxs.cvnets_in1k","mobilevit_xs.cvnets_in1k","mobilevit_s.cvnets_in1k"],"legendgroup":"mobilevit","marker":{"color":"#FF97FF","size":[65536,65536,65536],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"mobilevit","orientation":"v","showlegend":true,"x":[0.0006599091964945623,0.0010994931336653802,0.0013611738763509651],"xaxis":"x","y":[68.918,74.634,78.312],"yaxis":"y","type":"scatter"},{"customdata":[[240],[240],[240],[240],[240],[240],[240],[240],[240],[408],[408]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=crossvit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["crossvit_tiny_240.in1k","crossvit_9_240.in1k","crossvit_9_dagger_240.in1k","crossvit_small_240.in1k","crossvit_15_240.in1k","crossvit_15_dagger_240.in1k","crossvit_18_240.in1k","crossvit_18_dagger_240.in1k","crossvit_base_240.in1k","crossvit_15_dagger_408.in1k","crossvit_18_dagger_408.in1k"],"legendgroup":"crossvit","marker":{"color":"#FECB52","size":[57600,57600,57600,57600,57600,57600,57600,57600,57600,166464,166464],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"crossvit","orientation":"v","showlegend":true,"x":[0.0007573864109730144,0.0008087343307723412,0.0008364071295343722,0.0016024613806807258,0.001759138725679907,0.0018183140592043056,0.0024990628514307135,0.002577651759247326,0.004000160006400256,0.008588851670531649,0.011364927832708264],"xaxis":"x","y":[73.34,73.96,76.978,81.018,81.536,82.33,82.4,82.518,82.214,83.84,84.202],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetv2_50.a1h_in1k","resnetv2_101.a1h_in1k"],"legendgroup":"resnetv2","marker":{"color":"#636efa","size":[50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetv2","orientation":"v","showlegend":true,"x":[0.0007716049382716049,0.0013201494409167118],"xaxis":"x","y":[81.398,83.0],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convit_tiny.fb_in1k","convit_small.fb_in1k","convit_base.fb_in1k"],"legendgroup":"convit","marker":{"color":"#EF553B","size":[50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convit","orientation":"v","showlegend":true,"x":[0.0009024537718055393,0.0022212843466092097,0.004373496610540126],"xaxis":"x","y":[73.112,81.42,82.29],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetaad\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetaa50d.sw_in12k_ft_in1k","resnetaa101d.sw_in12k_ft_in1k"],"legendgroup":"resnetaad","marker":{"color":"#00cc96","size":[50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetaad","orientation":"v","showlegend":true,"x":[0.0010616387455676581,0.00160970976932859],"xaxis":"x","y":[82.6,84.124],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vgg11.tv_in1k","vgg11_bn.tv_in1k","vgg13.tv_in1k","vgg13_bn.tv_in1k","vgg16.tv_in1k","vgg16_bn.tv_in1k","vgg19.tv_in1k","vgg19_bn.tv_in1k"],"legendgroup":"vgg","marker":{"color":"#ab63fa","size":[50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vgg","orientation":"v","showlegend":true,"x":[0.001074575542660649,0.0012416499043929573,0.0015078180365193528,0.001758118110374655,0.001863967641521743,0.0021277953911951826,0.0022130748461912982,0.002501626056937009],"xaxis":"x","y":[69.022,70.382,69.932,71.588,71.592,73.37,72.378,74.216],"yaxis":"y","type":"scatter"},{"customdata":[[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetblur\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetblur50.bt_in1k"],"legendgroup":"resnetblur","marker":{"color":"#FFA15A","size":[50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetblur","orientation":"v","showlegend":true,"x":[0.001099408518217199],"xaxis":"x","y":[80.234],"yaxis":"y","type":"scatter"},{"customdata":[[224],[288],[320],[320],[352],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetrs\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetrs50.tf_in1k","resnetrs101.tf_in1k","resnetrs152.tf_in1k","resnetrs200.tf_in1k","resnetrs270.tf_in1k","resnetrs350.tf_in1k","resnetrs420.tf_in1k"],"legendgroup":"resnetrs","marker":{"color":"#19d3f3","size":[50176,82944,102400,102400,123904,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetrs","orientation":"v","showlegend":true,"x":[0.0011601466425356164,0.0031080997078386276,0.00584316933504733,0.00808080808080808,0.013285505513484789,0.021177467174925878,0.03105590062111801],"xaxis":"x","y":[79.894,82.284,83.702,84.444,84.428,84.714,85.004],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convnext_tiny.in12k_ft_in1k_384","convnext_tiny.in12k_ft_in1k","convnext_tiny.fb_in22k_ft_in1k_384","convnext_tiny.fb_in1k","convnext_tiny.fb_in22k_ft_in1k","convnext_tiny_hnf.a2h_in1k","convnext_small.in12k_ft_in1k_384","convnext_small.fb_in22k_ft_in1k_384","convnext_small.in12k_ft_in1k","convnext_small.fb_in22k_ft_in1k","convnext_small.fb_in1k","convnext_base.clip_laion2b_augreg_ft_in12k_in1k_384","convnext_base.fb_in22k_ft_in1k_384","convnext_base.clip_laiona_augreg_ft_in1k_384","convnext_base.clip_laion2b_augreg_ft_in12k_in1k","convnext_base.fb_in22k_ft_in1k","convnext_base.clip_laion2b_augreg_ft_in1k","convnext_base.fb_in1k","convnext_large.fb_in22k_ft_in1k_384","convnext_large.fb_in22k_ft_in1k","convnext_large.fb_in1k"],"legendgroup":"convnext","marker":{"color":"#FF6692","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convnext","orientation":"v","showlegend":true,"x":[0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0014666412448850886,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.005535872453498672,0.005535872453498672,0.005535872453498672],"xaxis":"x","y":[85.122,84.45,84.088,82.698,78.898,82.584,86.182,85.778,85.33,85.262,83.7,87.134,86.796,86.502,86.37,86.274,86.158,84.428,87.472,87.026,84.846],"yaxis":"y","type":"scatter"},{"customdata":[[288],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnetv2_rw_t.ra2_in1k","efficientnetv2_rw_s.ra2_in1k","efficientnetv2_rw_m.agc_in1k"],"legendgroup":"efficientnetv2","marker":{"color":"#B6E880","size":[82944,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnetv2","orientation":"v","showlegend":true,"x":[0.00146096306685367,0.0033831788348332096,0.007923302432453847],"xaxis":"x","y":[82.35,83.806,84.81],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[384],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["swin_tiny_patch4_window7_224.ms_in1k","swin_tiny_patch4_window7_224.ms_in22k_ft_in1k","swin_s3_tiny_224.ms_in1k","swin_small_patch4_window7_224.ms_in22k_ft_in1k","swin_small_patch4_window7_224.ms_in1k","swin_s3_small_224.ms_in1k","swin_base_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window7_224.ms_in1k","swin_s3_base_224.ms_in1k","swin_large_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in1k","swin_large_patch4_window12_384.ms_in22k_ft_in1k"],"legendgroup":"swin","marker":{"color":"#FF97FF","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,147456,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"swin","orientation":"v","showlegend":true,"x":[0.0015640885274106513,0.0015640885274106513,0.0017278319165111619,0.002542071279678682,0.002542071279678682,0.003609456776755098,0.0036254214552441724,0.0036254214552441724,0.004564750992833341,0.006607201850016518,0.013585110718652357,0.013585110718652357,0.024378352023403216],"xaxis":"x","y":[81.376,80.968,82.144,83.298,83.208,83.756,85.272,83.606,83.92,86.312,86.438,84.476,87.132],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[384],[384],[512]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["beit_base_patch16_224.in22k_ft_in22k_in1k","beit_large_patch16_224.in22k_ft_in22k_in1k","beit_base_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_512.in22k_ft_in22k_in1k"],"legendgroup":"beit","marker":{"color":"#FECB52","size":[50176,50176,147456,147456,262144],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"beit","orientation":"v","showlegend":true,"x":[0.0028385704958982655,0.009381743127873158,0.012087513598452797,0.039824771007566706,0.10615711252653928],"xaxis":"x","y":[85.212,87.478,86.8,88.402,88.596],"yaxis":"y","type":"scatter"},{"customdata":[[320],[320],[288],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetz\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetz_d8.ra3_in1k","regnetz_c16.ra3_in1k","regnetz_b16.ra3_in1k","regnetz_e8.ra3_in1k","regnetz_c16_evos.ch_in1k","regnetz_d8_evos.ch_in1k","regnetz_040.ra3_in1k","regnetz_d32.ra3_in1k"],"legendgroup":"regnetz","marker":{"color":"#636efa","size":[102400,102400,82944,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetz","orientation":"v","showlegend":true,"x":[0.0032123353678123997,0.003997441637352095,0.005506607929515419,0.006836671908115129,0.008684324793747285,0.010453690152623877,0.010575296108291032,0.013854253255749514],"xaxis":"x","y":[84.052,82.632,80.728,85.034,82.636,84.126,84.24,84.022],"yaxis":"y","type":"scatter"},{"customdata":[[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetv2d\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnetv2_50d_evos.ah_in1k"],"legendgroup":"resnetv2d","marker":{"color":"#EF553B","size":[82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetv2d","orientation":"v","showlegend":true,"x":[0.004472271914132379],"xaxis":"x","y":[82.002],"yaxis":"y","type":"scatter"},{"customdata":[[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetv\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetv_040.ra3_in1k","regnetv_064.ra3_in1k"],"legendgroup":"regnetv","marker":{"color":"#00cc96","size":[82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetv","orientation":"v","showlegend":true,"x":[0.008409014463504878,0.013925637097897228],"xaxis":"x","y":[83.19,83.716],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"secs"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"top1"}},"legend":{"title":{"text":"family"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"Training"},"height":800,"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a902debb-aa30-454c-90d5-2f2048b47fd4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
<p>…and we’ll also look at our chosen subset of models:</p>
<div id="cell-90" class="cell" data-executioninfo="{&quot;elapsed&quot;:374,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710785634893,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="6c66ffe7-c9bb-4fde-a8dc-71ec8899c2a7" data-execution_count="18">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>show_subs(tdf, <span class="st">'Training'</span>, <span class="st">'train_img_size'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<meta charset="utf-8">

    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="d2309f3d-5457-436f-823c-743773aa7ff3" class="plotly-graph-div" style="height:800px; width:1000px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d2309f3d-5457-436f-823c-743773aa7ff3")) {                    Plotly.newPlot(                        "d2309f3d-5457-436f-823c-743773aa7ff3",                        [{"customdata":[[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["levit_128s.fb_dist_in1k","levit_128.fb_dist_in1k","levit_192.fb_dist_in1k","levit_256.fb_dist_in1k","levit_384.fb_dist_in1k"],"legendgroup":"levit","marker":{"color":"#636efa","size":[50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"levit","orientation":"v","showlegend":true,"x":[0.00015865108501477042,0.00022550151537018326,0.00026151037934695625,0.000342053415061296,0.0005556697765651828],"xaxis":"x","y":[76.526,78.49,79.838,81.524,82.596],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 11.4692 * log10(secs) + 120.511\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.944142\u003cbr\u003e\u003cbr\u003efamily=levit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"levit","marker":{"color":"#636efa","symbol":"circle"},"mode":"lines","name":"levit","showlegend":false,"x":[0.00015865108501477042,0.00022550151537018326,0.00026151037934695625,0.000342053415061296,0.0005556697765651828],"xaxis":"x","y":[76.93258762509899,78.68401528081017,79.42194052016585,80.75931208901773,83.17614448490721],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[256],[256],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[288],[288]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18.fb_swsl_ig1b_ft_in1k","resnet18.a1_in1k","resnet18.fb_ssl_yfcc100m_ft_in1k","resnet18.a2_in1k","resnet18.gluon_in1k","resnet18.tv_in1k","resnet18.a3_in1k","resnet34.a1_in1k","resnet34.a2_in1k","resnet34.bt_in1k","resnet34.gluon_in1k","resnet34.tv_in1k","resnet34.a3_in1k","resnet26.bt_in1k","resnet26t.ra2_in1k","resnet50.a1_in1k","resnet50.fb_swsl_ig1b_ft_in1k","resnet50.d_in1k","resnet50.c1_in1k","resnet50.c2_in1k","resnet50.tv2_in1k","resnet50.a2_in1k","resnet50.b1k_in1k","resnet50.a1h_in1k","resnet50.b2k_in1k","resnet50.ram_in1k","resnet50.ra_in1k","resnet50.bt_in1k","resnet50.fb_ssl_yfcc100m_ft_in1k","resnet50.am_in1k","resnet50.a3_in1k","resnet50.gluon_in1k","resnet50.tv_in1k","resnet32ts.ra2_in1k","resnet33ts.ra2_in1k","resnet101.a1h_in1k","resnet101.a1_in1k","resnet101.a2_in1k","resnet101.tv2_in1k","resnet101.a3_in1k","resnet101.gluon_in1k","resnet101.tv_in1k","resnet152.a1h_in1k","resnet152.a1_in1k","resnet152.a2_in1k","resnet152.tv2_in1k","resnet152.a3_in1k","resnet152.gluon_in1k","resnet152.tv_in1k","resnet51q.ra2_in1k","resnet61q.ra2_in1k"],"legendgroup":"resnet","marker":{"color":"#EF553B","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,65536,65536,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,82944,82944],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnet","orientation":"v","showlegend":true,"x":[0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0005087349795997273,0.000814431730260211,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0009786938352075321,0.0009906973518659784,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0035980282805022847,0.004809773459670049],"xaxis":"x","y":[73.288,73.158,72.598,72.372,70.834,69.76,68.252,77.918,77.158,76.48,74.58,73.306,72.97,76.366,78.328,81.214,81.172,80.972,80.912,80.87,80.848,80.772,80.706,80.678,80.454,79.976,79.836,79.64,79.23,79.002,78.048,77.582,76.128,79.388,79.726,82.778,82.322,82.236,81.888,79.814,79.31,77.38,83.45,82.732,82.608,82.286,80.546,79.696,78.322,82.36,82.524],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 10.4488 * log10(secs) + 110.577\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.675192\u003cbr\u003e\u003cbr\u003efamily=resnet\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"resnet","marker":{"color":"#EF553B","symbol":"circle"},"mode":"lines","name":"resnet","showlegend":false,"x":[0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.000279003066243698,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0004805543675183692,0.0005087349795997273,0.000814431730260211,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0008179223137386412,0.0009786938352075321,0.0009906973518659784,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0013745704467353953,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0020006802312786346,0.0035980282805022847,0.004809773459670049],"xaxis":"x","y":[73.43784095342211,73.43784095342211,73.43784095342211,73.43784095342211,73.43784095342211,73.43784095342211,73.43784095342211,75.90515576424117,75.90515576424117,75.90515576424117,75.90515576424117,75.90515576424117,75.90515576424117,76.1637541262708,78.29910533940551,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,78.31851265655507,79.13283859762376,79.18815616318271,80.67424872865095,80.67424872865095,80.67424872865095,80.67424872865095,80.67424872865095,80.67424872865095,80.67424872865095,82.37751646535719,82.37751646535719,82.37751646535719,82.37751646535719,82.37751646535719,82.37751646535719,82.37751646535719,85.04078136899986,86.35795896906725],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[320],[320],[320],[320],[320]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["resnet18d.ra2_in1k","resnet34d.ra2_in1k","resnet26d.bt_in1k","resnet50d.a1_in1k","resnet50d.ra2_in1k","resnet50d.a2_in1k","resnet50d.gluon_in1k","resnet50d.a3_in1k","resnet101d.ra2_in1k","resnet101d.gluon_in1k","resnet152d.ra2_in1k","resnet152d.gluon_in1k","resnet200d.ra2_in1k"],"legendgroup":"resnetd","marker":{"color":"#00cc96","size":[50176,50176,50176,50176,50176,50176,50176,50176,102400,102400,102400,102400,102400],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"resnetd","orientation":"v","showlegend":true,"x":[0.0003533543932551713,0.0005558550996926121,0.0006213611537433903,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.003054274457102715,0.003054274457102715,0.0046277014207043365,0.0046277014207043365,0.006017209218364523],"xaxis":"x","y":[73.794,78.436,77.408,81.45,81.356,81.164,79.078,78.72,83.02,80.426,83.684,80.476,83.964],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 5.46988 * log10(secs) + 95.789\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.628388\u003cbr\u003e\u003cbr\u003efamily=resnetd\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"resnetd","marker":{"color":"#00cc96","symbol":"circle"},"mode":"lines","name":"resnetd","showlegend":false,"x":[0.0003533543932551713,0.0005558550996926121,0.0006213611537433903,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.0009343960531110716,0.003054274457102715,0.003054274457102715,0.0046277014207043365,0.0046277014207043365,0.006017209218364523],"xaxis":"x","y":[76.90812679592943,77.98433166410675,78.24897814719262,79.21816917926508,79.21816917926508,79.21816917926508,79.21816917926508,79.21816917926508,82.03174990936297,82.03174990936297,83.01882949179769,83.01882949179769,83.64255869412521],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["regnetx_002.pycls_in1k","regnetx_004.pycls_in1k","regnetx_006.pycls_in1k","regnetx_008.tv2_in1k","regnetx_008.pycls_in1k","regnetx_016.tv2_in1k","regnetx_016.pycls_in1k","regnetx_032.tv2_in1k","regnetx_032.pycls_in1k","regnetx_040.pycls_in1k","regnetx_080.tv2_in1k","regnetx_080.pycls_in1k","regnetx_064.pycls_in1k","regnetx_120.pycls_in1k","regnetx_160.tv2_in1k","regnetx_160.pycls_in1k","regnetx_320.tv2_in1k","regnetx_320.pycls_in1k"],"legendgroup":"regnetx","marker":{"color":"#ab63fa","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"regnetx","orientation":"v","showlegend":true,"x":[0.0004215904922912179,0.0008689456213830139,0.0012649261283141065,0.001689760054072322,0.001689760054072322,0.002637061258933045,0.002637061258933045,0.005628095452498874,0.005628095452498874,0.006177796997590659,0.0066657778962804955,0.0066657778962804955,0.008056070248932571,0.012896569512509672,0.015382248884786955,0.015382248884786955,0.021663778162911613,0.021663778162911613],"xaxis":"x","y":[68.752,72.402,73.868,77.306,75.028,79.436,76.924,80.926,78.168,78.492,81.54,79.198,79.066,79.588,82.566,79.866,82.81,80.246],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 6.57079 * log10(secs) + 93.4658\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.807089\u003cbr\u003e\u003cbr\u003efamily=regnetx\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"regnetx","marker":{"color":"#ab63fa","symbol":"circle"},"mode":"lines","name":"regnetx","showlegend":false,"x":[0.0004215904922912179,0.0008689456213830139,0.0012649261283141065,0.001689760054072322,0.001689760054072322,0.002637061258933045,0.002637061258933045,0.005628095452498874,0.005628095452498874,0.006177796997590659,0.0066657778962804955,0.0066657778962804955,0.008056070248932571,0.012896569512509672,0.015382248884786955,0.015382248884786955,0.021663778162911613,0.021663778162911613],"xaxis":"x","y":[71.28863635495333,73.35253264960107,74.42404790619054,75.25038939457298,75.25038939457298,76.5204910492055,76.5204910492055,78.68386542709419,78.68386542709419,78.94979953601042,79.16674859590171,79.16674859590171,79.70734313624683,81.05008997352192,81.5530550884513,81.5530550884513,82.53022566651215,82.53022566651215],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["vgg11.tv_in1k","vgg11_bn.tv_in1k","vgg13.tv_in1k","vgg13_bn.tv_in1k","vgg16.tv_in1k","vgg16_bn.tv_in1k","vgg19.tv_in1k","vgg19_bn.tv_in1k"],"legendgroup":"vgg","marker":{"color":"#FFA15A","size":[50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"vgg","orientation":"v","showlegend":true,"x":[0.001074575542660649,0.0012416499043929573,0.0015078180365193528,0.001758118110374655,0.001863967641521743,0.0021277953911951826,0.0022130748461912982,0.002501626056937009],"xaxis":"x","y":[69.022,70.382,69.932,71.588,71.592,73.37,72.378,74.216],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 12.9585 * log10(secs) + 107.374\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.885938\u003cbr\u003e\u003cbr\u003efamily=vgg\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"vgg","marker":{"color":"#FFA15A","symbol":"circle"},"mode":"lines","name":"vgg","showlegend":false,"x":[0.001074575542660649,0.0012416499043929573,0.0015078180365193528,0.001758118110374655,0.001863967641521743,0.0021277953911951826,0.0022130748461912982,0.002501626056937009],"xaxis":"x","y":[68.90298324828235,69.71628704046168,70.80933322468678,71.6736533954418,72.00267376015793,72.74767704773944,72.96882981982678,73.65856246340243],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[224]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["convnext_tiny.in12k_ft_in1k_384","convnext_tiny.in12k_ft_in1k","convnext_tiny.fb_in22k_ft_in1k_384","convnext_tiny.fb_in1k","convnext_tiny.fb_in22k_ft_in1k","convnext_tiny_hnf.a2h_in1k","convnext_small.in12k_ft_in1k_384","convnext_small.fb_in22k_ft_in1k_384","convnext_small.in12k_ft_in1k","convnext_small.fb_in22k_ft_in1k","convnext_small.fb_in1k","convnext_base.clip_laion2b_augreg_ft_in12k_in1k_384","convnext_base.fb_in22k_ft_in1k_384","convnext_base.clip_laiona_augreg_ft_in1k_384","convnext_base.clip_laion2b_augreg_ft_in12k_in1k","convnext_base.fb_in22k_ft_in1k","convnext_base.clip_laion2b_augreg_ft_in1k","convnext_base.fb_in1k","convnext_large.fb_in22k_ft_in1k_384","convnext_large.fb_in22k_ft_in1k","convnext_large.fb_in1k"],"legendgroup":"convnext","marker":{"color":"#19d3f3","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,50176],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"convnext","orientation":"v","showlegend":true,"x":[0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0014666412448850886,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.005535872453498672,0.005535872453498672,0.005535872453498672],"xaxis":"x","y":[85.122,84.45,84.088,82.698,78.898,82.584,86.182,85.778,85.33,85.262,83.7,87.134,86.796,86.502,86.37,86.274,86.158,84.428,87.472,87.026,84.846],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 6.17519 * log10(secs) + 101.288\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.439434\u003cbr\u003e\u003cbr\u003efamily=convnext\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"convnext","marker":{"color":"#19d3f3","symbol":"circle"},"mode":"lines","name":"convnext","showlegend":false,"x":[0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0012801310854231474,0.0014666412448850886,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0021101943488995335,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.0030553009471432934,0.005535872453498672,0.005535872453498672,0.005535872453498672],"xaxis":"x","y":[83.42472180338534,83.42472180338534,83.42472180338534,83.42472180338534,83.42472180338534,83.78948700648866,84.76515847525603,84.76515847525603,84.76515847525603,84.76515847525603,84.76515847525603,85.75770660464568,85.75770660464568,85.75770660464568,85.75770660464568,85.75770660464568,85.75770660464568,85.75770660464568,87.35172178926092,87.35172178926092,87.35172178926092],"yaxis":"y","type":"scatter"},{"customdata":[[288],[384],[416]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["efficientnetv2_rw_t.ra2_in1k","efficientnetv2_rw_s.ra2_in1k","efficientnetv2_rw_m.agc_in1k"],"legendgroup":"efficientnetv2","marker":{"color":"#FF6692","size":[82944,147456,173056],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"efficientnetv2","orientation":"v","showlegend":true,"x":[0.00146096306685367,0.0033831788348332096,0.007923302432453847],"xaxis":"x","y":[82.35,83.806,84.81],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 3.34886 * log10(secs) + 91.9238\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.988050\u003cbr\u003e\u003cbr\u003efamily=efficientnetv2\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"efficientnetv2","marker":{"color":"#FF6692","symbol":"circle"},"mode":"lines","name":"efficientnetv2","showlegend":false,"x":[0.00146096306685367,0.0033831788348332096,0.007923302432453847],"xaxis":"x","y":[82.42858624521678,83.64986848133402,84.88754527344928],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[224],[224],[224],[224],[224],[224],[224],[224],[384],[384],[384]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["swin_tiny_patch4_window7_224.ms_in1k","swin_tiny_patch4_window7_224.ms_in22k_ft_in1k","swin_s3_tiny_224.ms_in1k","swin_small_patch4_window7_224.ms_in22k_ft_in1k","swin_small_patch4_window7_224.ms_in1k","swin_s3_small_224.ms_in1k","swin_base_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window7_224.ms_in1k","swin_s3_base_224.ms_in1k","swin_large_patch4_window7_224.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in22k_ft_in1k","swin_base_patch4_window12_384.ms_in1k","swin_large_patch4_window12_384.ms_in22k_ft_in1k"],"legendgroup":"swin","marker":{"color":"#B6E880","size":[50176,50176,50176,50176,50176,50176,50176,50176,50176,50176,147456,147456,147456],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"swin","orientation":"v","showlegend":true,"x":[0.0015640885274106513,0.0015640885274106513,0.0017278319165111619,0.002542071279678682,0.002542071279678682,0.003609456776755098,0.0036254214552441724,0.0036254214552441724,0.004564750992833341,0.006607201850016518,0.013585110718652357,0.013585110718652357,0.024378352023403216],"xaxis":"x","y":[81.376,80.968,82.144,83.298,83.208,83.756,85.272,83.606,83.92,86.312,86.438,84.476,87.132],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 4.39329 * log10(secs) + 94.3862\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.778111\u003cbr\u003e\u003cbr\u003efamily=swin\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"swin","marker":{"color":"#B6E880","symbol":"circle"},"mode":"lines","name":"swin","showlegend":false,"x":[0.0015640885274106513,0.0015640885274106513,0.0017278319165111619,0.002542071279678682,0.002542071279678682,0.003609456776755098,0.0036254214552441724,0.0036254214552441724,0.004564750992833341,0.006607201850016518,0.013585110718652357,0.013585110718652357,0.024378352023403216],"xaxis":"x","y":[82.05981506767431,82.05981506767431,82.24978153696058,82.9864753951552,82.9864753951552,83.65537155240705,83.66379196953142,83.66379196953142,84.10337814611505,84.80894227038542,86.18424168350984,86.18424168350984,87.29987826239132],"yaxis":"y","type":"scatter"},{"customdata":[[224],[224],[384],[384],[512]],"hovertemplate":"\u003cb\u003e%{hovertext}\u003c\u002fb\u003e\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y}\u003cbr\u003esize=%{marker.size}\u003cbr\u003etrain_img_size=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","hovertext":["beit_base_patch16_224.in22k_ft_in22k_in1k","beit_large_patch16_224.in22k_ft_in22k_in1k","beit_base_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_384.in22k_ft_in22k_in1k","beit_large_patch16_512.in22k_ft_in22k_in1k"],"legendgroup":"beit","marker":{"color":"#FF97FF","size":[50176,50176,147456,147456,262144],"sizemode":"area","sizeref":655.36,"symbol":"circle"},"mode":"markers","name":"beit","orientation":"v","showlegend":true,"x":[0.0028385704958982655,0.009381743127873158,0.012087513598452797,0.039824771007566706,0.10615711252653928],"xaxis":"x","y":[85.212,87.478,86.8,88.402,88.596],"yaxis":"y","type":"scatter"},{"hovertemplate":"\u003cb\u003eOLS trendline\u003c\u002fb\u003e\u003cbr\u003etop1 = 2.11281 * log10(secs) + 91.0441\u003cbr\u003eR\u003csup\u003e2\u003c\u002fsup\u003e=0.866259\u003cbr\u003e\u003cbr\u003efamily=beit\u003cbr\u003esecs=%{x}\u003cbr\u003etop1=%{y} \u003cb\u003e(trend)\u003c\u002fb\u003e\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"beit","marker":{"color":"#FF97FF","symbol":"circle"},"mode":"lines","name":"beit","showlegend":false,"x":[0.0028385704958982655,0.009381743127873158,0.012087513598452797,0.039824771007566706,0.10615711252653928],"xaxis":"x","y":[85.66299314096136,86.75993002199235,86.99245203535588,88.08649956032822,88.98612524136213],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"secs"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"top1"}},"legend":{"title":{"text":"family"},"tracegroupgap":0,"itemsizing":"constant"},"title":{"text":"Training"},"height":800,"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d2309f3d-5457-436f-823c-743773aa7ff3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>


</div>
</div>
<p>Finally, we should remember that speed depends on hardware. If you’re using something other than a modern NVIDIA GPU, your results may be different. In particular, I suspect that transformers-based models might have worse performance in general on CPUs (although I need to study this more to be sure).</p>
</section>
<section id="use-model" class="level2">
<h2 class="anchored" data-anchor-id="use-model">Use model</h2>
<div id="cell-93" class="cell" data-executioninfo="{&quot;elapsed&quot;:239,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787652534,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="f0b6ab09-93ae-498f-f1d4-86554429bd08" data-execution_count="25">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd ..<span class="op">/</span>..</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/content/drive/MyDrive/fastai course/Aula 1, 2 e 3.1</code></pre>
</div>
</div>
<div id="cell-94" class="cell" data-executioninfo="{&quot;elapsed&quot;:1910582,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787548950,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="c92ddbf2-7076-4b7a-9279-c73661f4c819" data-execution_count="19">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">-</span>Uqq timm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.2/2.2 MB 9.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 23.7/23.7 MB 30.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 823.6/823.6 kB 34.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.1/14.1 MB 17.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 731.7/731.7 MB 578.9 kB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 410.6/410.6 MB 927.3 kB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.6/121.6 MB 1.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.5/56.5 MB 1.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 124.2/124.2 MB 1.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 196.0/196.0 MB 1.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 166.0/166.0 MB 975.8 kB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.1/99.1 kB 1.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 21.1/21.1 MB 1.3 MB/s eta 0:00:00</code></pre>
</div>
</div>
<div id="cell-95" class="cell" data-executioninfo="{&quot;elapsed&quot;:217,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787658214,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> timm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-96" class="cell" data-executioninfo="{&quot;elapsed&quot;:237,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787660593,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">"images"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-97" class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787662049,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="28">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_cat(x): <span class="cf">return</span> x.name[<span class="dv">0</span>].isupper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-98" class="cell" data-executioninfo="{&quot;elapsed&quot;:371,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787663299,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                get_items<span class="op">=</span>get_image_files,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                splitter<span class="op">=</span>RandomSplitter(valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                get_y<span class="op">=</span>is_cat, item_tfms<span class="op">=</span>Resize(<span class="dv">192</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-99" class="cell" data-executioninfo="{&quot;elapsed&quot;:2035,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787666207,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="f0c55d5b-0f35-4956-97fc-97c6b81a7bed" data-execution_count="30">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-100" class="cell" data-executioninfo="{&quot;elapsed&quot;:176944,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710787852654,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="21cf4a44-c88d-4bb7-e36f-c167fb56e611" data-execution_count="32">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading: "https://download.pytorch.org/models/resnet18-f37072fd.pth" to /root/.cache/torch/hub/checkpoints/resnet18-f37072fd.pth
100%|██████████| 44.7M/44.7M [00:01&lt;00:00, 34.9MB/s]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.199996</td>
<td>0.070748</td>
<td>0.023004</td>
<td>00:49</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.076861</td>
<td>0.030587</td>
<td>0.010149</td>
<td>00:40</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.040507</td>
<td>0.031452</td>
<td>0.010149</td>
<td>00:42</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.021061</td>
<td>0.025538</td>
<td>0.008796</td>
<td>00:42</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-101" class="cell" data-executioninfo="{&quot;elapsed&quot;:293,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710788431832,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="8c52e215-ec0e-4b0a-e484-28d3720b879f" data-execution_count="39">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>timm.list_models(<span class="st">"convnext*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>['convnext_atto',
 'convnext_atto_ols',
 'convnext_base',
 'convnext_femto',
 'convnext_femto_ols',
 'convnext_large',
 'convnext_large_mlp',
 'convnext_nano',
 'convnext_nano_ols',
 'convnext_pico',
 'convnext_pico_ols',
 'convnext_small',
 'convnext_tiny',
 'convnext_tiny_hnf',
 'convnext_xlarge',
 'convnext_xxlarge',
 'convnextv2_atto',
 'convnextv2_base',
 'convnextv2_femto',
 'convnextv2_huge',
 'convnextv2_large',
 'convnextv2_nano',
 'convnextv2_pico',
 'convnextv2_small',
 'convnextv2_tiny']</code></pre>
</div>
</div>
<div id="cell-102" class="cell" data-executioninfo="{&quot;elapsed&quot;:185367,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1710788206692,&quot;user&quot;:{&quot;displayName&quot;:&quot;Afonso Matoso Magalhães&quot;,&quot;userId&quot;:&quot;00834841139025641156&quot;},&quot;user_tz&quot;:0}" data-outputid="ddf04ab6-f272-4562-f1bf-01c11b5194bd" data-execution_count="35">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, <span class="st">"convnext_tiny.fb_in22k"</span>, metrics<span class="op">=</span>error_rate).to_fp16()</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/timm/models/_factory.py:117: UserWarning:

Mapping deprecated model name convnext_tiny_in22k to current convnext_tiny.fb_in22k.

/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning:


The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7387305248e74a30a6a881efce3e6490","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.059403</td>
<td>0.011887</td>
<td>0.003383</td>
<td>00:45</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.011285</td>
<td>0.010708</td>
<td>0.003383</td>
<td>00:44</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.011494</td>
<td>0.013424</td>
<td>0.004736</td>
<td>00:45</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.003962</td>
<td>0.008315</td>
<td>0.002706</td>
<td>00:45</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li>The convnext model increased the performance of the resnet18 model by 225% (form 0.0088 error rate to 0.0027), while minimaly increasing training duration (~4 seconds per epoch).</li>
</ul>
</section>
</section>
<section id="mnist" class="level1">
<h1>MNIST</h1>
<ul>
<li>AstroDave, Will Cukierski. (2012). Digit Recognizer. Kaggle. https://kaggle.com/competitions/digit-recognizer</li>
</ul>
<section id="load-data-1" class="level2">
<h2 class="anchored" data-anchor-id="load-data-1">Load Data</h2>
<div id="cell-106" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-107" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> pd.read_csv(<span class="st">"./data/mnist/train.csv"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.read_csv(<span class="st">"./data/mnist/test.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-108" class="cell" data-outputid="0b05de82-0ada-41d3-dabd-9fc563bed614">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>display(train_df.head(<span class="dv">2</span>))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>display(test_df.head(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">label</th>
<th data-quarto-table-cell-role="th">pixel0</th>
<th data-quarto-table-cell-role="th">pixel1</th>
<th data-quarto-table-cell-role="th">pixel2</th>
<th data-quarto-table-cell-role="th">pixel3</th>
<th data-quarto-table-cell-role="th">pixel4</th>
<th data-quarto-table-cell-role="th">pixel5</th>
<th data-quarto-table-cell-role="th">pixel6</th>
<th data-quarto-table-cell-role="th">pixel7</th>
<th data-quarto-table-cell-role="th">pixel8</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pixel774</th>
<th data-quarto-table-cell-role="th">pixel775</th>
<th data-quarto-table-cell-role="th">pixel776</th>
<th data-quarto-table-cell-role="th">pixel777</th>
<th data-quarto-table-cell-role="th">pixel778</th>
<th data-quarto-table-cell-role="th">pixel779</th>
<th data-quarto-table-cell-role="th">pixel780</th>
<th data-quarto-table-cell-role="th">pixel781</th>
<th data-quarto-table-cell-role="th">pixel782</th>
<th data-quarto-table-cell-role="th">pixel783</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>2 rows × 785 columns</p>
</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pixel0</th>
<th data-quarto-table-cell-role="th">pixel1</th>
<th data-quarto-table-cell-role="th">pixel2</th>
<th data-quarto-table-cell-role="th">pixel3</th>
<th data-quarto-table-cell-role="th">pixel4</th>
<th data-quarto-table-cell-role="th">pixel5</th>
<th data-quarto-table-cell-role="th">pixel6</th>
<th data-quarto-table-cell-role="th">pixel7</th>
<th data-quarto-table-cell-role="th">pixel8</th>
<th data-quarto-table-cell-role="th">pixel9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pixel774</th>
<th data-quarto-table-cell-role="th">pixel775</th>
<th data-quarto-table-cell-role="th">pixel776</th>
<th data-quarto-table-cell-role="th">pixel777</th>
<th data-quarto-table-cell-role="th">pixel778</th>
<th data-quarto-table-cell-role="th">pixel779</th>
<th data-quarto-table-cell-role="th">pixel780</th>
<th data-quarto-table-cell-role="th">pixel781</th>
<th data-quarto-table-cell-role="th">pixel782</th>
<th data-quarto-table-cell-role="th">pixel783</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>2 rows × 784 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-109" class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_X_y(df: pd.DataFrame,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>            train: <span class="bu">bool</span>,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>            frac: <span class="bu">float</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>            random_state: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> train:</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>        sample_df <span class="op">=</span> df.groupby(<span class="st">"label"</span>).sample(frac<span class="op">=</span>frac, random_state<span class="op">=</span>random_state)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        X, y <span class="op">=</span> sample_df.iloc[:, <span class="dv">1</span>:].values, sample_df.iloc[:, <span class="dv">0</span>].values</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> df.values</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="va">None</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>).astype(np.uint8)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.moveaxis(np.stack((X,) <span class="op">*</span> <span class="dv">3</span>, axis<span class="op">=</span><span class="dv">1</span>), source<span class="op">=</span><span class="dv">1</span>, destination<span class="op">=-</span><span class="dv">1</span>), y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-110" class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>train_X, train_y <span class="op">=</span> get_X_y(train_df, train<span class="op">=</span><span class="va">True</span>, frac<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>test_X, _ <span class="op">=</span> get_X_y(test_df, train<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-111" class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> <span class="st">"./data/mnist/train"</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>test_dir <span class="op">=</span> <span class="st">"./data/mnist/test"</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(train_dir):</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    os.mkdir(train_dir)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(test_dir):</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    os.mkdir(test_dir)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> np.unique(train_y):</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(<span class="ss">f"</span><span class="sc">{</span>train_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span>):</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>        os.mkdir(<span class="ss">f"</span><span class="sc">{</span>train_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-112" class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(train_X.shape[<span class="dv">0</span>]):</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    Image.fromarray(train_X[i]).save(<span class="ss">f"</span><span class="sc">{</span>train_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>train_y[i]<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.jpg"</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(test_X.shape[<span class="dv">0</span>]):</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    Image.fromarray(test_X[i]).save(<span class="ss">f"</span><span class="sc">{</span>test_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.jpg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-model-1" class="level2">
<h2 class="anchored" data-anchor-id="train-model-1">Train Model</h2>
<div id="cell-114" class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-115" class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks <span class="op">=</span> (ImageBlock, CategoryBlock),</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                get_items <span class="op">=</span> get_image_files,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                get_y <span class="op">=</span> parent_label,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                splitter <span class="op">=</span> RandomSplitter()</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(train_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-116" class="cell" data-outputid="27365472-2963-4398-ec6f-51bcf0ae5bd1">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-71-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-117" class="cell" data-outputid="a209b1d9-ad5d-4486-845b-2e55cf314599">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>dls.n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1681</code></pre>
</div>
</div>
<div id="cell-118" class="cell" data-outputid="a76d341d-7562-4e22-9ef0-ec94c18a71ef">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.799451</td>
<td>1.431905</td>
<td>0.459524</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.452900</td>
<td>1.000913</td>
<td>0.314286</td>
<td>00:08</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.127767</td>
<td>0.726985</td>
<td>0.219048</td>
<td>00:08</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.822714</td>
<td>0.569272</td>
<td>0.164286</td>
<td>00:08</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.580217</td>
<td>0.472451</td>
<td>0.142857</td>
<td>00:08</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.394636</td>
<td>0.403461</td>
<td>0.116667</td>
<td>00:08</td>
</tr>
<tr class="even">
<td>5</td>
<td>0.281271</td>
<td>0.356165</td>
<td>0.102381</td>
<td>00:08</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.194676</td>
<td>0.374367</td>
<td>0.109524</td>
<td>00:08</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.137263</td>
<td>0.370997</td>
<td>0.107143</td>
<td>00:08</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.103021</td>
<td>0.350598</td>
<td>0.104762</td>
<td>00:08</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.083260</td>
<td>0.356768</td>
<td>0.107143</td>
<td>00:08</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-119" class="cell" data-outputid="e408a51c-d225-4ccb-ec6d-17862c06e5c2">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>interp <span class="op">=</span> ClassificationInterpretation.from_learner(learn)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>interp.plot_confusion_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-74-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-120" class="cell" data-outputid="00ae7df2-b5f9-4241-ded6-bf32cdc93dad">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>interp.plot_top_losses(<span class="dv">5</span>, nrows<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">17</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-75-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can correct images annotations or remove them, using the <code>ImageClassifierCleaner</code>. That will show the images for each class (in the train or validation set) where the trained model had the highest classification error. Let’s import the required modules:</p>
<div id="cell-122" class="cell" data-outputid="fbe97879-4935-478b-acd3-447ea8c0d1b1">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.widgets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>cleaner <span class="op">=</span> ImageClassifierCleaner(learn)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>cleaner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d2869267eaa54337b5ee733b9d0db0cd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>Each time we make a change in one class’s and data set’s (train/validation) samples, by reannotating/removing it, we need to run the following lines before changing to another class or data set, so the changes are applied to the actual data:</p>
<div id="cell-124" class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind <span class="kw">in</span> cleaner.delete(): cleaner.fns[ind].unlink()</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind, cat <span class="kw">in</span> cleaner.change(): shutil.move(<span class="bu">str</span>(cleaner.fns[ind]), <span class="ss">f"</span><span class="sc">{</span>train_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>cat<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the end of validating the data, we need to create a new <code>DataLoaders</code> object, to reflect the changes made to the dataset, and retrain the model.</p>
<div id="cell-126" class="cell" data-outputid="26df0a63-a48b-4304-d6ce-cb6cdb20c760">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks <span class="op">=</span> (ImageBlock, CategoryBlock),</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                get_items <span class="op">=</span> get_image_files,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                get_y <span class="op">=</span> parent_label,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                splitter <span class="op">=</span> RandomSplitter()</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(train_dir)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>interp <span class="op">=</span> ClassificationInterpretation.from_learner(learn)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>interp.plot_confusion_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.888510</td>
<td>1.503774</td>
<td>0.525301</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.519504</td>
<td>1.011998</td>
<td>0.330120</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.199548</td>
<td>0.672037</td>
<td>0.221687</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.866976</td>
<td>0.474139</td>
<td>0.137349</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.597648</td>
<td>0.332307</td>
<td>0.101205</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.420963</td>
<td>0.318540</td>
<td>0.096386</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>5</td>
<td>0.295351</td>
<td>0.311173</td>
<td>0.086747</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.213994</td>
<td>0.280651</td>
<td>0.081928</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.154817</td>
<td>0.255272</td>
<td>0.067470</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.112886</td>
<td>0.267510</td>
<td>0.069880</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.089455</td>
<td>0.275279</td>
<td>0.077108</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-78-output-9.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-127" class="cell" data-outputid="bfe9e44d-466d-4f23-cac4-bfecb5714f54">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>dls.n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1662</code></pre>
</div>
</div>
</section>
<section id="test-model-1" class="level2">
<h2 class="anchored" data-anchor-id="test-model-1">Test Model</h2>
<div id="cell-129" class="cell" data-outputid="a6e8d8ca-0772-4d3f-ec00-a6605cb560db">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"./data/mnist/sample_submission.csv"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ImageId</th>
<th data-quarto-table-cell-role="th">Label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-130" class="cell" data-outputid="e08b0f67-7717-4dab-eadc-5f3185218c36">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>test_dl <span class="op">=</span> dls.test_dl(get_image_files(test_dir))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>preds_probs <span class="op">=</span> learn.get_preds(dl<span class="op">=</span>test_dl)[<span class="dv">0</span>]  <span class="co"># probs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="cell-131" class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> pd.Series(preds_probs.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>).indices, name<span class="op">=</span><span class="st">"Label"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>ids <span class="op">=</span> pd.Series(data<span class="op">=</span>[<span class="bu">int</span>(item.name[:<span class="op">-</span><span class="dv">4</span>])<span class="op">+</span><span class="dv">1</span> <span class="cf">for</span> item <span class="kw">in</span> test_dl.dataset.items], name<span class="op">=</span><span class="st">"ImageId"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-132" class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>submission_df <span class="op">=</span> pd.concat((ids, preds), axis<span class="op">=</span><span class="dv">1</span>).sort_values(by<span class="op">=</span><span class="st">"ImageId"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-133" class="cell" data-outputid="2d3dcfc4-242c-4ec8-b6a9-27afef966648">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>submission_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ImageId</th>
<th data-quarto-table-cell-role="th">Label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">27898</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26377</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24566</td>
<td>3</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26165</td>
<td>4</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21011</td>
<td>5</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-134" class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>submission_df.to_csv(<span class="st">"./data/mnist/submission.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We only used 5% of the data for training and validation, to make it faster, so, after iterating this process enough to be confident of our data processing and validation methods, and our model’s architecture and hypeparameters, we would retrain and validate it on the whole dataset.</p>
<div id="cell-136" class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shutil <span class="im">import</span> rmtree</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>rmtree(train_dir)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>rmtree(test_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="animals" class="level1">
<h1>Animals</h1>
<ul>
<li>The Pan African Programme: The Cultured Chimpanzee, Wild Chimpanzee Foundation, DrivenData. (2022). Conser-vision Practice Area: Image Classification. Retrieved [Month Day Year] from https://www.drivendata.org/competitions/87/competition-image-classification-wildlife-conservation/.</li>
</ul>
<section id="load-data-2" class="level2">
<h2 class="anchored" data-anchor-id="load-data-2">Load Data</h2>
<div id="cell-139" class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-140" class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> pd.read_csv(<span class="st">"./data/animals/train-labels.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-141" class="cell" data-outputid="a484097e-30dc-40d7-98d7-90a3a36e3dea">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>labels.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">antelope_duiker</th>
<th data-quarto-table-cell-role="th">bird</th>
<th data-quarto-table-cell-role="th">blank</th>
<th data-quarto-table-cell-role="th">civet_genet</th>
<th data-quarto-table-cell-role="th">hog</th>
<th data-quarto-table-cell-role="th">leopard</th>
<th data-quarto-table-cell-role="th">monkey_prosimian</th>
<th data-quarto-table-cell-role="th">rodent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ZJ000000</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ZJ000001</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-142" class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>labels[<span class="st">"label"</span>] <span class="op">=</span> labels.iloc[:, <span class="dv">1</span>:].idxmax(axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> labels[[<span class="st">"id"</span>, <span class="st">"label"</span>]].set_index(<span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-143" class="cell" data-outputid="ae8038a9-9886-4cd9-9631-0be50b8f16e1">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>display(labels.head(<span class="dv">2</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(labels.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">label</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZJ000000</td>
<td>bird</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZJ000001</td>
<td>monkey_prosimian</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(16488, 1)</code></pre>
</div>
</div>
<div id="cell-144" class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>labels_sample <span class="op">=</span> labels.groupby(<span class="st">"label"</span>).sample(frac<span class="op">=</span><span class="fl">0.05</span>)[<span class="st">"label"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-145" class="cell" data-outputid="09071784-9207-4b4b-a0e6-715f8caf38f7">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>labels_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>id
ZJ009857    antelope_duiker
ZJ006205    antelope_duiker
ZJ015289    antelope_duiker
ZJ002203    antelope_duiker
ZJ008486    antelope_duiker
                 ...       
ZJ012387             rodent
ZJ008316             rodent
ZJ012197             rodent
ZJ004787             rodent
ZJ007973             rodent
Name: label, Length: 826, dtype: object</code></pre>
</div>
</div>
</section>
<section id="train-model-2" class="level2">
<h2 class="anchored" data-anchor-id="train-model-2">Train Model</h2>
<div id="cell-147" class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-148" class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>train_path <span class="op">=</span> <span class="st">"./data/animals/train/"</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>test_path <span class="op">=</span> <span class="st">"./data/animals/test/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-149" class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_items(path):</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> Path(path)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> []</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> os.listdir(path):</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> filename[:<span class="op">-</span><span class="dv">4</span>] <span class="kw">in</span> labels_sample.index:</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>            res.append(path<span class="op">/</span>filename)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> L(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-150" class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                get_items<span class="op">=</span>get_items,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                get_y<span class="op">=</span><span class="kw">lambda</span> x: labels_sample.loc[x.name[:<span class="op">-</span><span class="dv">4</span>]],</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                splitter<span class="op">=</span>RandomSplitter(),</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>                item_tfms<span class="op">=</span>Resize(<span class="dv">128</span>, method<span class="op">=</span><span class="st">"squish"</span>),</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                batch_tfms<span class="op">=</span>[Normalize.from_stats(<span class="op">*</span>imagenet_stats)]</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>               ).dataloaders(train_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-151" class="cell" data-outputid="2d2017d4-31e5-44db-8cc3-6b769a633d18">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-98-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-152" class="cell" data-outputid="035129ac-a90d-45d3-ff00-d4bd4f62c15a">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>dls.n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>661</code></pre>
</div>
</div>
<div id="cell-153" class="cell" data-outputid="580567ba-c1d2-48ae-fcb5-8d9185a9fe9c">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> vision_learner(dls, resnet18, metrics<span class="op">=</span>error_rate)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>learn.fine_tune(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>3.050437</td>
<td>2.190669</td>
<td>0.696970</td>
<td>00:10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<div>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.883267</td>
<td>1.707361</td>
<td>0.551515</td>
<td>00:12</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.671480</td>
<td>1.513506</td>
<td>0.436364</td>
<td>00:12</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.359095</td>
<td>1.500973</td>
<td>0.460606</td>
<td>00:12</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.100571</td>
<td>1.569371</td>
<td>0.448485</td>
<td>00:11</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.877178</td>
<td>1.688496</td>
<td>0.460606</td>
<td>00:11</td>
</tr>
<tr class="even">
<td>5</td>
<td>0.698931</td>
<td>1.693306</td>
<td>0.478788</td>
<td>00:11</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.563536</td>
<td>1.697963</td>
<td>0.430303</td>
<td>00:11</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.463716</td>
<td>1.748586</td>
<td>0.448485</td>
<td>00:11</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.376198</td>
<td>1.744868</td>
<td>0.448485</td>
<td>00:11</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.311529</td>
<td>1.747836</td>
<td>0.454545</td>
<td>00:11</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-154" class="cell" data-outputid="86956a44-b76e-4e83-a01e-4f2b2fbc5611">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>interp <span class="op">=</span> ClassificationInterpretation.from_learner(learn)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>interp.plot_confusion_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-101-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-155" class="cell" data-outputid="f31ce4a2-8714-4afb-eb7d-f278c217f361">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>interp.plot_top_losses(k<span class="op">=</span><span class="dv">5</span>, nrows<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">22</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="fastai-img-classif-2_files/figure-html/cell-102-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-156" class="cell" data-outputid="00e865fd-c1a0-463e-b264-77a86474cb82">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.widgets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>cleaner <span class="op">=</span> ImageClassifierCleaner(learn)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>cleaner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f54eab3ff63a4b6887b39eceeeab71ba","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>I can’t see enough to validate the images.</p>
</section>
<section id="test-model-2" class="level2">
<h2 class="anchored" data-anchor-id="test-model-2">Test Model</h2>
<div id="cell-159" class="cell" data-outputid="0febaf5e-81c4-4ef3-bc6b-28fe36dce4c5">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"./data/animals/sample-submission.csv"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">antelope_duiker</th>
<th data-quarto-table-cell-role="th">bird</th>
<th data-quarto-table-cell-role="th">blank</th>
<th data-quarto-table-cell-role="th">civet_genet</th>
<th data-quarto-table-cell-role="th">hog</th>
<th data-quarto-table-cell-role="th">leopard</th>
<th data-quarto-table-cell-role="th">monkey_prosimian</th>
<th data-quarto-table-cell-role="th">rodent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ZJ016488</td>
<td>0.048233</td>
<td>0.189185</td>
<td>0.044914</td>
<td>0.199588</td>
<td>0.106118</td>
<td>0.132915</td>
<td>0.166410</td>
<td>0.112637</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ZJ016489</td>
<td>0.097078</td>
<td>0.061400</td>
<td>0.026409</td>
<td>0.241530</td>
<td>0.144344</td>
<td>0.051780</td>
<td>0.287811</td>
<td>0.089648</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ZJ016490</td>
<td>0.124658</td>
<td>0.089101</td>
<td>0.189225</td>
<td>0.174494</td>
<td>0.180540</td>
<td>0.079995</td>
<td>0.085672</td>
<td>0.076314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ZJ016491</td>
<td>0.109966</td>
<td>0.048397</td>
<td>0.055598</td>
<td>0.323600</td>
<td>0.322356</td>
<td>0.063252</td>
<td>0.008160</td>
<td>0.068671</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ZJ016492</td>
<td>0.165742</td>
<td>0.184610</td>
<td>0.005431</td>
<td>0.136806</td>
<td>0.000389</td>
<td>0.122078</td>
<td>0.151521</td>
<td>0.233423</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-160" class="cell" data-outputid="eac5e169-b85d-475d-fec1-eb9c732ab688">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>test_dl <span class="op">=</span> dls.test_dl(get_image_files(test_path))</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>preds_probs <span class="op">=</span> learn.get_preds(dl<span class="op">=</span>test_dl)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div id="cell-161" class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>ids <span class="op">=</span> np.array([item.name[:<span class="op">-</span><span class="dv">4</span>] <span class="cf">for</span> item <span class="kw">in</span> test_dl.dataset.items])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-162" class="cell" data-outputid="96993416-bccf-49a2-973e-2b4a9e519dfe">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>learn.dls.vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['antelope_duiker', 'bird', 'blank', 'civet_genet', 'hog', 'leopard', 'monkey_prosimian', 'rodent']</code></pre>
</div>
</div>
<div id="cell-163" class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>submission_df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>preds_probs, columns<span class="op">=</span> learn.dls.vocab)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>submission_df.insert(<span class="dv">0</span>, <span class="st">"id"</span>, ids)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>submission_df.sort_values(by<span class="op">=</span><span class="st">"id"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-164" class="cell" data-outputid="5acfc948-34f8-4931-9264-b3f8f81b1904">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>submission_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">antelope_duiker</th>
<th data-quarto-table-cell-role="th">bird</th>
<th data-quarto-table-cell-role="th">blank</th>
<th data-quarto-table-cell-role="th">civet_genet</th>
<th data-quarto-table-cell-role="th">hog</th>
<th data-quarto-table-cell-role="th">leopard</th>
<th data-quarto-table-cell-role="th">monkey_prosimian</th>
<th data-quarto-table-cell-role="th">rodent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1901</td>
<td>ZJ016488</td>
<td>0.003612</td>
<td>6.942989e-04</td>
<td>0.323665</td>
<td>5.332318e-01</td>
<td>0.020963</td>
<td>0.100759</td>
<td>1.180175e-02</td>
<td>0.005273</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1693</td>
<td>ZJ016489</td>
<td>0.026071</td>
<td>8.592082e-02</td>
<td>0.024220</td>
<td>4.086171e-03</td>
<td>0.834774</td>
<td>0.011074</td>
<td>1.285491e-02</td>
<td>0.000999</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2752</td>
<td>ZJ016490</td>
<td>0.030828</td>
<td>5.230120e-02</td>
<td>0.045449</td>
<td>1.384969e-01</td>
<td>0.718519</td>
<td>0.003206</td>
<td>7.886172e-03</td>
<td>0.003315</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2542</td>
<td>ZJ016491</td>
<td>0.000002</td>
<td>8.615297e-08</td>
<td>0.000002</td>
<td>3.867934e-07</td>
<td>0.000002</td>
<td>0.999990</td>
<td>9.170705e-07</td>
<td>0.000002</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2254</td>
<td>ZJ016492</td>
<td>0.500051</td>
<td>1.019086e-02</td>
<td>0.049266</td>
<td>3.648468e-02</td>
<td>0.045658</td>
<td>0.003554</td>
<td>3.501456e-01</td>
<td>0.004649</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-165" class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>submission_df.to_csv(<span class="st">"./data/animals/submission.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"03b8fef1fe674d209990b11c816ccb3d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"363d1c3910e34068a72edc708f8c9874":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7387305248e74a30a6a881efce3e6490":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dc111f97fd8449d98fbad5ee4f0e9b1d","IPY_MODEL_d965f63f1f1b4ccab524fe368cb656dc","IPY_MODEL_a32eaa6759c04f4f87c22bbc068f6414"],"layout":"IPY_MODEL_922efd47f82b4520b7b4d6b126a08a09"}},"8d172e85ecf34c76af7c6a65b239e179":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"922efd47f82b4520b7b4d6b126a08a09":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a32eaa6759c04f4f87c22bbc068f6414":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_363d1c3910e34068a72edc708f8c9874","placeholder":"​","style":"IPY_MODEL_03b8fef1fe674d209990b11c816ccb3d","value":" 178M/178M [00:02&lt;00:00, 91.5MB/s]"}},"c5a9dca90f85400f97ebb29edfdfe08e":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d965f63f1f1b4ccab524fe368cb656dc":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e2d1c3e070b34fd5a582998a93792ba7","max":178481432,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8d172e85ecf34c76af7c6a65b239e179","value":178481432}},"dc111f97fd8449d98fbad5ee4f0e9b1d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fb58416bf0404fb5836fd578d41726f8","placeholder":"​","style":"IPY_MODEL_c5a9dca90f85400f97ebb29edfdfe08e","value":"model.safetensors: 100%"}},"e2d1c3e070b34fd5a582998a93792ba7":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb58416bf0404fb5836fd578d41726f8":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/afonsomm\.github\.io\/blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>